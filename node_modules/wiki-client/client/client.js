/*! wiki-client - v0.23.0 - 2021-02-28
 * Copyright 2021 Ward Cunningham and other contributors;
 * Released under the MIT license */
!function(){return function t(e,n,r){function o(a,u){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return o(e[a][1][t]||t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}}()({1:[function(t,e,n){"use strict";console.log("Window Name: "+window.name),window.name=window.location.host,window.wiki=t("./lib/wiki"),t("./lib/legacy"),t("./lib/bind"),t("./lib/plugins")},{"./lib/bind":5,"./lib/legacy":14,"./lib/plugins":24,"./lib/wiki":38}],2:[function(t,e,n){"use strict";var r,o,i;o=(i={create:"☼",add:"+",edit:"✎",fork:"⚑",move:"↕",remove:"✕"}).fork,r=i.add,e.exports={symbols:i,fork:o,add:r}},{}],3:[function(t,e,n){"use strict";var r,o,i;e.exports=r={},r.scrollContainer=void 0,o=function(){var t;return(t=$("body, html").filter(function(){return $(this).scrollLeft()>0})).length>0?t:$("body, html").scrollLeft(12).filter(function(){return $(this).scrollLeft()>0}).scrollTop(0)},i=function(t){var e,n,i,a,u,c,s;if(null!=t.position())return null==r.scrollContainer&&(r.scrollContainer=o()),e=$("body").width(),i=(a=r.scrollContainer.scrollLeft())+e,c=t.position().left,s=t.outerWidth(!0),n=$(".page").outerWidth(!0)*$(".page").length,c<a?u=c:c+s>i?u=c-(e-s):i>$(".pages").outerWidth()&&(u=Math.min(c,n-e)),r.scrollContainer.animate({scrollLeft:u},function(){if(!$.contains(t[0],document.activeElement))return t.focus()})},r.set=function(t,e){if($(".incremental-search").remove(),t=$(t),$(".active").removeClass("active"),t.addClass("active"),!e)return i(t)}},{}],4:[function(t,e,n){"use strict";var r,o;o=t("./util"),r=t("./actionSymbols"),e.exports=function(t,e){var n,i,a,u;if(i=t.parents(".page:first"),u="",null!=e.site&&(u+="".concat(e.site,"\n")),u+=e.type||"separator",null!=e.date&&(u+=" ".concat(o.formatElapsedTime(e.date))),n=$('<a href="#" /> ').addClass("action").addClass(e.type||"separator").text(e.symbol||r.symbols[e.type]).attr("title",u).attr("data-id",e.id||"0").data("action",e),(a=t.children(".control-buttons")).length>0?n.insertBefore(a):n.appendTo(t),"fork"===e.type&&null!=e.site)return n.css("background-image","url(".concat(wiki.site(e.site).flag())).attr("href","".concat(wiki.site(e.site).getDirectURL(i.attr("id")),".html")).attr("target","".concat(e.site)).data("site",e.site).data("slug",i.attr("id"))}},{"./actionSymbols":2,"./util":37}],5:[function(t,e,n){"use strict";var r,o,i,a,u;o=t("./neighborhood"),i=t("./neighbors"),a=t("./searchbox"),u=t("./state"),r=t("./link"),$(function(){return a.inject(o),a.bind(),i.inject(o),i.bind(),window.seedNeighbors&&seedNeighbors.split(",").forEach(function(t){return o.registerNeighbor(t.trim())}),u.inject(r)})},{"./link":17,"./neighborhood":18,"./neighbors":19,"./searchbox":31,"./state":34}],6:[function(t,e,n){"use strict";var r,o,i,a;a=t("./resolve"),r=null,o=function(){return r=$("<div></div>").html("This dialog will show every time!").dialog({autoOpen:!1,title:"Basic Dialog",height:600,width:800})},i=function(t,e){return r.html(e),r.dialog("option","title",a.resolveLinks(t)),r.dialog("open")},e.exports={emit:o,open:i}},{"./resolve":28}],7:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i,a,u,c,s,l,f,d=[].indexOf;f=t("url"),a=function(t){var e;return null!=(e=t.originalEvent.dataTransfer)&&d.call(e.types,"Files")>=0?e.files[0]:null},s=function(t){var e,n;return null!=(e=t.originalEvent.dataTransfer)&&null!=e.types&&(d.call(e.types,"text/uri-list")>=0||d.call(e.types,"text/x-moz-url")>=0)&&(null!=(n=e.getData("URL"))?n.length:void 0)?n:null},c=function(t){var e,n,o,i;if(e=t.match(/^https?:\/\/([a-zA-Z0-9:.-]+)(\/([a-zA-Z0-9:.-]+)\/([a-z0-9-]+(_rev\d+)?))+$/)){n={};var a=r(e,6);return a[0],o=a[1],a[2],n.site=a[3],n.slug=a[4],a[5],"view"!==(i=n.site)&&"local"!==i&&"origin"!==i||(n.site=o),n}return null},u=function(t){return f.parse(t,!0,!0).pathname.match(/\.(jpg|jpeg|png|svg)$/i)?t:null},l=function(t){var e;e=f.parse(t,!0,!0);try{"video"===e.query.source&&(e=f.parse(e.query.url,!0,!0))}catch(t){t}switch(e.hostname){case"www.youtube.com":return null!=e.query.list?{text:"YOUTUBE PLAYLIST ".concat(e.query.list)}:{text:"YOUTUBE ".concat(e.query.v)};case"youtu.be":return null!=e.query.list?{text:"YOUTUBE PLAYLIST ".concat(e.query.list)}:{text:"YOUTUBE ".concat(e.pathname.substr(1))};case"vimeo.com":return{text:"VIMEO ".concat(e.pathname.substr(1))};case"archive.org":return{text:"ARCHIVE ".concat(e.pathname.substr(e.pathname.lastIndexOf("/")+1))};case"tedxtalks.ted.com":return{text:"TEDX ".concat(e.pathname.substr(e.pathname.lastIndexOf("/")+1))};case"www.ted.com":return{text:"TED ".concat(e.pathname.substr(e.pathname.lastIndexOf("/")+1))};default:return null}},i=function(t){return function(e){var n,r,o,i,f,d,h,p,g;if(h=function(t){return e.preventDefault(),e.stopPropagation()},p=s(e)){if((i=c(p))&&null!=(r=t.page))return h(r(i));if((g=l(p))&&null!=(r=t.video))return h(r(g));if((o=u(p))&&null!=(r=t.image))return h(r(o));f={url:p}}if(n=a(e)){if(null!=(r=t.file))return h(r(n));f={file:n}}if(null!=(r=t.punt))return f||(f={dt:e.dataTransfer,types:null!=(d=e.dataTransfer)?d.types:void 0}),h(r(f))}},e.exports={dispatch:i}},{url:65}],8:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f,d;c=t("./plugin"),i=t("./itemz"),u=t("./pageHandler"),a=t("./link"),s=t("./random"),r=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},d=function(t,e){var n,s,h,p,g,v,m,y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(console.log("textEditor",e.id,y),"markdown"===e.type&&(s=0),$(".editEnable").is(":visible")&&(p=function(r){var u,c,l,h,p,g,v,m,b;if(27===r.which)return r.preventDefault(),n.focusout(),!1;if((r.ctrlKey||r.metaKey)&&83===r.which)return r.preventDefault(),n.focusout(),!1;if((r.ctrlKey||r.metaKey)&&73===r.which)return r.preventDefault(),r.shiftKey||(h=$(r.target).parents(".page")),a.doInternalLink("about ".concat(e.type," plugin"),h),!1;if((r.ctrlKey||r.metaKey)&&77===r.which)return r.preventDefault(),t.removeClass(e.type).addClass(e.type="factory"),n.focusout(),!1;if("paragraph"===e.type||"markdown"===e.type){if(v=o(n),r.which===$.ui.keyCode.BACKSPACE&&0===v.start&&v.start===v.end)return c=t.prev(),(g=i.getItem(c)).type===e.type&&(l=g[y.field||"text"].length,m=n.val(),n.val(""),d(c,g,{caret:l,suffix:m}),!1);if(r.which===$.ui.keyCode.ENTER){if(!v)return!1;if("markdown"===e.type&&s++,"paragraph"===e.type||"markdown"===e.type&&2===s)return u=t.parents(".page"),p=(b=n.val()).substring(0,v.start),m=b.substring(v.end),""===p?(n.val(m),n.focusout(),f(u,t.prev(),e.type,p)):(n.val(p),n.focusout(),f(u,t,e.type,m)),!1}else if("markdown"===e.type)return s=0}},h=function(){var r,o;if(t.removeClass("textEditing"),n.unbind(),r=t.parents(".page:first"),e[y.field||"text"]=n.val())if(t.removeClass("output-item"),t.removeClass(function(t,e){return(e.match(/\S+-source/)||[]).join(" ")}),c.do(t.empty(),e),y.after){if(""===e[y.field||"text"])return;u.put(r,{type:"add",id:e.id,item:e,after:y.after})}else{if(e[y.field||"text"]===g)return;u.put(r,{type:"edit",id:e.id,item:e})}else y.after||u.put(r,{type:"remove",id:e.id}),o=$(".item").index(t),t.remove(),c.renderFrom(o);return null},!t.hasClass("textEditing")))return t.addClass("textEditing"),t.unbind(),g=null!=(v=e[y.field||"text"])?v:"",n=$("<textarea>".concat(r(g)).concat(r(null!=(m=y.suffix)?m:""),"</textarea>")).focusout(h).bind("keydown",p),t.html(n),y.caret?l(n,y.caret):y.append?(l(n,n.val().length),n.scrollTop(n[0].scrollHeight-n.height())):n.focus()},f=function(t,e,n,r){var o,a,u;return u={type:n,id:s.itemId(),text:r},(o=$('<div class="item '.concat(u.type,'" data-id=').concat(u.id,"></div>"))).data("item",u).data("pageElement",t),e.after(o),a=i.getItem(e),d(o,u,{after:null!=a?a.id:void 0})},o=function(t){var e,n,r;return e=t.get(0),document.selection?(e.focus(),(r=document.selection.createRange()).moveStart("character",-e.value.length),{start:n=r.text.length,end:n}):{start:e.selectionStart,end:e.selectionEnd}},l=function(t,e){var n,r;if(null!=(n=t.get(0)))return n.createTextRange?((r=n.createTextRange()).move("character",e),r.select()):n.setSelectionRange(e,e),n.focus()},e.exports={textEditor:d}},{"./itemz":13,"./link":17,"./pageHandler":21,"./plugin":23,"./random":25}],9:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i,a,u,c,s,l,f,d,h,p,g,v,m,y,b;p=t("./neighborhood"),v=t("./plugin"),y=t("./resolve"),g=t("./pageHandler"),l=t("./editor"),b=t("./synopsis"),s=t("./drop"),i=t("./active"),d=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>")},f=function(t,e){var n,r;return t.append("<p>Double-Click to Edit<br>Drop Text or Image to Insert</p>"),n=function(){var n,r,o,a,u,c;for(u=t.find("p").append('<br>Or Choose a Plugin\n<center>\n<table style="text-align:left;">\n<tr><td><ul id=format><td><ul id=data><td><ul id=other>'),r=0,a=(c=window.catalog).length;r<a;r++)(o=c[r])&&o.category&&("format"!==(n=o.category)&&"data"!==n&&(n="other"),u.find("#"+n).append('<li><a class="menu" href="#" title="'.concat(o.title,'">').concat(o.name,"</a></li>")));return u.find("a.menu").click(function(n){var r,o,a;if(a=(o=n.target.text).toLowerCase(),t.removeClass("factory").addClass(e.type=a),t.unbind(),n.preventDefault(),i.set(t.parents(".page")),!window.catalog.find(function(t){return o===t.name}).editor)return l.textEditor(t,e);try{return window.plugins[a].editor(t,e)}catch(n){return r=n,console.log("".concat(o," Plugin editor failed: ").concat(r,". Falling back to textEditor")),l.textEditor(t,e)}})},r=function(){return t.append("<p>".concat(y.resolveLinks(e.prompt,d),"</b>"))},e.prompt?r():null!=window.catalog?n():wiki.origin.get("system/factories.json",function(t,e){return console.log("factory",e),window.catalog=e,n()})},u=function(t,e){var n,o,i,u,f,d;return d=function(){var n,r;t.empty().unbind(),t.removeClass("factory").addClass(e.type),n=t.parents(".page:first");try{t.data("pageElement",n),t.data("item",e),v.getPlugin(e.type,function(n){return n.emit(t,e),n.bind(t,e)})}catch(e){r=e,t.append("<p class='error'>".concat(r,"</p>"))}return g.put(n,{type:"edit",id:e.id,item:e})},u=function(t){return e.prompt="Unexpected Item\nWe can't make sense of the drop.\nTry something else or see [[About Factory Plugin]].",t.userAgent=navigator.userAgent,e.punt=t,d()},n=function(t){return wiki.site(t.site).get("".concat(t.slug,".json"),function(n,r){if(!n&&(e.type="reference",e.site=t.site,e.slug=t.slug,e.title=r.title||t.slug,e.text=b(r),d(),null!=e.site))return p.registerNeighbor(e.site)})},i=function(t){return e.type="video",e.text="".concat(t.text,"\n(double-click to edit caption)\n"),d()},o=function(t){return document.documentElement.style.cursor="wait",h(t).then(function(t){return m(t)}).then(function(n){return document.documentElement.style.cursor="default",e.type="image",e.url=n,e.source=t,e.caption||(e.caption="Remote image"),d()})},f=function(t){var n,o,i;if(null!=t){var s=r(t.type.split("/"),2);return n=s[0],o=s[1],i=new FileReader,"image"===n?(i.onload=function(t){return m(t.target.result).then(function(t){return e.type="image",e.url=t,e.caption||(e.caption="Uploaded image"),d()})},i.readAsDataURL(t)):"text"===n?(i.onload=function(n){var r,i;return i=n.target.result,"csv"===o?(e.type="data",e.columns=(r=c(i))[0],e.data=a(r),e.text=t.fileName):(e.type="paragraph",e.text=i),d()},i.readAsText(t)):u({name:t.name,type:t.type,size:t.size,fileName:t.fileName,lastModified:t.lastModified})}},t.dblclick(function(n){return n.shiftKey?l.textEditor(t,e,{field:"prompt"}):(t.removeClass("factory").addClass(e.type="paragraph"),t.unbind(),l.textEditor(t,e))}),t.bind("dragenter",function(t){return t.preventDefault()}),t.bind("dragover",function(t){return t.preventDefault()}),t.bind("drop",s.dispatch({page:n,file:f,video:i,image:o,punt:u}))},c=function(t,e){var n,r,o,i,a;for(e=e||",",o=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),n=[[]],r=null;r=o.exec(t);)(i=r[1]).length&&i!==e&&n.push([]),a=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],n[n.length-1].push(a);return n},a=function(t){var e,n,o,i,a,u;for(e=t.shift(),u=function(t){var n,o,i,a,u,c;for(a={},n=0,i=(u=_.zip(e,t)).length;n<i;n++){var s=r(u[n],2);o=s[0],null!=(c=s[1])&&c.match(/\S/)&&"NULL"!==c&&(a[o]=c)}return a},i=[],n=0,o=t.length;n<o;n++)a=t[n],i.push(u(a));return i},h=function(t){var e;return e=function(t){var e;return e="",[].slice.call(new Uint8Array(t)).forEach(function(t){return e+=String.fromCharCode(t)}),window.btoa(e)},fetch(t).then(function(t){if(t.ok)return t;throw new Error("Unable to fetch image")}).then(function(t){return t.arrayBuffer().then(function(t){var n;return n="data:image/jpeg;base64,",n+=e(t)})}).catch(function(t){return console.log("Unable to fetch remote image")})},m=function(t){var e,n,r,o;return o=new Image,n=void 0,e=void 0,500,300,.5,r=function(t){return t.width<=500||t.height<=300},new Promise(function(e){return o.src=t,o.onload=function(){return e()}}).then(function(){return n=o.naturalWidth,e=o.naturalHeight}).then(function(){var t,i,a;if(!r(o))return i=Math.max(1,Math.min(n/500,e/300)),t=Math.floor(Math.log2(i)),a=i/Math.pow(2,t),n=Math.round(n/a),e=Math.round(e/a)}).then(function(){return new Promise(function(i){var a;return(a=new Image).src=o.src,a.onload=function(){var o;return r(a)?i(t):((o=document.createElement("canvas")).width=n,o.height=e,o.getContext("2d").drawImage(a,0,0,n,e),t=o.toDataURL("image/jpeg",.5),n/=2,e/=2,a.src=t)}})}).then(function(){return t})},e.exports={emit:f,bind:u}},{"./active":3,"./drop":7,"./editor":8,"./neighborhood":18,"./pageHandler":21,"./plugin":23,"./resolve":28,"./synopsis":35}],10:[function(t,e,n){"use strict";var r,o,i,a,u,c;c=t("./resolve"),a=t("./neighborhood"),i=t("./lineup"),u=t("./refresh"),o=function(t,e){var n,r,o,i,u,s,l,f;if(t.append("".concat(e.text,'<br><br><button class="create">create</button> new blank page')),(f=null!=(i=e.create)&&null!=(u=i.source)?u.transport:void 0)&&(t.append('<br><button class="transport" data-slug='.concat(e.slug,">create</button> transport from ").concat(f)),t.append("<p class=caption> unavailable</p>"),$.get("//localhost:4020",function(){return t.find(".caption").text("ready")})),null!=(r=a.sites[location.host])&&null!=r.sitemap){for(l=[],n=0,o=(s=r.sitemap).length;n<o;n++)(e=s[n]).slug.match(/-template$/)?l.push(t.append('<br><button class="create" data-slug='.concat(e.slug,">create</button> from ").concat(c.resolveLinks("[[".concat(e.title,"]]"))))):l.push(void 0);return l}},r=function(t,e){return t.find("button.transport").click(function(n){var r,o;return t.find(".caption").text("waiting"),r={title:t.parents(".page").data("data").title,create:e.create},o={type:"POST",url:e.create.source.transport,dataType:"json",contentType:"application/json",data:JSON.stringify(r)},$.ajax(o).done(function(e){var n,r,o;return t.find(".caption").text("ready"),o=wiki.newPage(e),n=t.parents(".page"),(r=i.atKey(n.data("key"))).become(o,o),e=r.getRawPage(),u.rebuildPage(r,n.empty())})})},e.exports={emit:o,bind:r}},{"./lineup":16,"./neighborhood":18,"./refresh":27,"./resolve":28}],11:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l;o=t("./dialog"),i=t("./editor"),l=t("./resolve"),u=!1,c=!1,s=function(){return c=!0,"http://127.0.0.1:8080",$.ajax("".concat("http://127.0.0.1:8080","/ipfs/Qmb1oS3TaS8vekxXqogoYsixe47sXcVxQ22kPWH8VSd7yQ"),{timeout:3e4,success:function(t){return u="wiki\n"===t},complete:function(t,e){return console.log("ipfs gateway ".concat(e))}})},a=function(t,e){return e.text||(e.text=e.caption),t.append('<img class=thumbnail src="'.concat(e.url,'"> <p>').concat(l.resolveLinks(e.text),"</p>"))},r=function(t,e){return t.dblclick(function(){return i.textEditor(t,e)}),e.ipfs&&!c&&s(),t.find("img").dblclick(function(t){var n;return t.stopPropagation(),n=u&&null!=e.ipfs?"".concat(gateway,"/ipfs/").concat(e.ipfs):null!=e.source?e.source:e.url,o.open(e.text,'<img style="width:100%" src="'.concat(n,'">'))})},e.exports={emit:a,bind:r}},{"./dialog":6,"./editor":8,"./resolve":28}],12:[function(t,e,n){"use strict";var r,o,i,a,u,c;c=t("./util"),a=t("./link"),u=t("./page").newPage,i=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},o=function(t,e){var n;return n=function(t){var e,n,r,o,a;for(a in o=[],t)r=t[a],n="<a href=".concat(a,">").concat(i(r.title)||a,"</a>"),r.journal&&((e=r.journal[r.journal.length-1].date)?n+=" &nbsp; from ".concat(c.formatElapsedTime(e)):n+=" &nbsp; from revision ".concat(r.journal.length-1)),o.push(n);return o.join("<br>")},t.append('<p style="background-color:#eee;padding:15px;">\n  '.concat(n(e.pages),"\n</p>"))},r=function(t,e){return t.find("a").click(function(t){var n,r,o;return o=$(t.target).attr("href"),t.shiftKey||(n=$(t.target).parents(".page")),r=u(e.pages[o]),a.showResult(r,{$page:n,rev:r.getRevision()}),!1})},e.exports={emit:o,bind:r}},{"./link":17,"./page":20,"./util":37}],13:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l;i=t("./pageHandler"),a=t("./plugin"),u=t("./random"),l=function(t,e){return setTimeout(e,t)},o=function(t){if($(t).length>0)return $(t).data("item")||$(t).data("staticItem")},c=function(t,e){return i.put(t.parents(".page:first"),{type:"remove",id:e.id}),t.remove()},r=function(t,e,n){var r,c;return null==t&&(t=e.parents(".page")),n.id=u.itemId(),(r=$('<div class="item '.concat(n.type,'" data-id=""</div>'))).data("item",n).data("pageElement",t),null!=e?e.after(r):t.find(".story").append(r),a.do(r,n),c=o(e),l(500,function(){return i.put(t,{item:n,id:n.id,type:"add",after:null!=c?c.id:void 0})}),r},s=function(t,e,n){var r,o,u;u=$.extend({},n),t.empty().unbind(),t.removeClass(e).addClass(u.type),r=t.parents(".page:first");try{t.data("pageElement",r),t.data("item",u),a.getPlugin(n.type,function(e){return e.emit(t,u),e.bind(t,u)})}catch(e){o=e,t.append("<p class='error'>".concat(o,"</p>"))}return i.put(r,{type:"edit",id:u.id,item:u})},e.exports={createItem:r,removeItem:c,getItem:o,replaceItem:s}},{"./pageHandler":21,"./plugin":23,"./random":25}],14:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f,d,h,p,g,v;f=t("./pageHandler"),g=t("./state"),r=t("./active"),p=t("./refresh"),c=t("./lineup"),a=t("./drop"),i=t("./dialog"),s=t("./link"),v=t("./target"),u=t("./license"),d=t("./plugin"),o=t("./page").asSlug,l=t("./page").newPage,h=function(t){return t.filter(function(t){return t.editor}).forEach(function(t){return console.log("".concat(t.name," Plugin declares an editor, so pre-loading the plugin")),wiki.getPlugin(t.name.toLowerCase(),function(e){if(!e.editor||"function"!=typeof e.editor)return console.log("".concat(t.name,' Plugin ERROR.\nCannot find `editor` function in plugin. Set `"editor": false` in factory.json or\nCorrect the plugin to include all three of `{emit, bind, editor}`'))})})},wiki.origin.get("system/factories.json",function(t,e){return window.catalog=e,h(e)}),$(function(){var t,e,n,h,m,y,b;return i.emit(),37,39,$(document).keydown(function(t){var e,n,o;if((e=function(){switch(t.which){case 37:return-1;case 39:return 1}}())&&!$(t.target).is(":input")&&0<=(n=(o=$(".page")).index($(".active"))+e)&&n<o.length&&r.set(o.eq(n)),(t.ctrlKey||t.metaKey)&&83===t.which)return t.preventDefault(),$("input.search").focus()}),$(window).on("popstate",g.show),$(document).ajaxError(function(t,e,n){if(0!==e.status&&404!==e.status)return console.log("ajax error",t,e,n)}),t=function(t){return"".concat(t).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},b=function(e){var n;if("application/json"===(null!=e?e.type:void 0))return(n=new FileReader).onload=function(n){var r,o,i;return o=n.target.result,r=JSON.parse(o),(i=l()).setTitle("Import from ".concat(e.name)),i.addParagraph("Import of ".concat(Object.keys(r).length," pages\n(").concat(t(e.size)," bytes)\nfrom an export file dated ").concat(e.lastModifiedDate,".")),i.addItem({type:"importer",pages:r}),s.showResult(i)},n.readAsText(e)},e=function(t,e){return console.log("fork to delete"),f.delete(t,e,function(n){var r;if(null==n)return console.log("server delete successful"),t.isRecycler()?e.addClass("ghost"):(r=p.newFuturePage(t.getTitle(),t.getCreate()),t.become(r),e.attr("id",r.getSlug()),p.rebuildPage(t,e),e.addClass("ghost"))})},m=function(t,e){return t?(console.log("getTemplate",t),f.get({whenGotten:function(t,n){return e(t)},whenNotGotten:function(){return e(null)},pageInformation:{slug:t}})):e(null)},n=function(t,e){var n;return t.preventDefault(),t.shiftKey||(n=$(t.target).parents(".page")),s.doInternalLink(e,n,$(t.target).data("site")),!1},y=null,$(".main").sortable({handle:".page-handle",cursor:"grabbing"}).on("sortstart",function(t,e){if(e.item.hasClass("page"))return!0,r.set(e.item,!0),y=$(".page").index(e.item[0])}).on("sort",function(t,e){var n;if(e.item.hasClass("page"))return n=e.item,t.pageY<0&&$(".page").length>2?n.addClass("pending-remove"):n.removeClass("pending-remove")}).on("sortstop",function(t,e){var n,o,i,a;if(e.item.hasClass("page")){if(n=e.item,a=(o=$(".page")).index($(".active")),i=$(".item").index(n.find(".item")[0]),n.hasClass("pending-remove")){if(1===o.length)return;c.removeKey(n.data("key")),n.remove(),r.set($(".page")[a])}else c.changePageIndex(n.data("key"),a),r.set($(".active")),y<a&&(a=y,i=$(".item").index($($(".page")[a]).find(".item")[0]));return d.renderFrom(i),g.setUrl(),g.debugStates()}}).delegate(".show-page-license","click",function(t){var e,n;return t.preventDefault(),n=(e=$(this).parents(".page")).find("h1").text().trim(),i.open("License for ".concat(n),u.info(e))}).delegate(".show-page-source","click",function(t){var e,n;return t.preventDefault(),e=$(this).parents(".page"),n=c.atKey(e.data("key")).getRawPage(),i.open("JSON for ".concat(n.title),$("<pre/>").text(JSON.stringify(n,null,2)))}).delegate(".page","click",function(t){if(!$(t.target).is("a"))return r.set(this)}).delegate(".internal","click",function(t){var e,r;return r=(e=$(t.target)).text()||e.data("pageName"),r="".concat(r),f.context=$(t.target).attr("title").split(" => "),n(t,r)}).delegate("img.remote","click",function(t){var e,r;return $(t.target).attr("src").startsWith("data:image/png")?(t.preventDefault(),r=$(t.target).data("site"),wiki.site(r).refresh(function(){})):(e=$(t.target).data("slug"),f.context=[$(t.target).data("site")],n(t,e))}).delegate(".revision","dblclick",function(t){var e,n,r,o,a;return t.preventDefault(),e=$(this).parents(".page"),a=(o=c.atKey(e.data("key")).getRawPage()).journal.length-1,n=o.journal[a],r=JSON.stringify(n,null,2),i.open("Revision ".concat(a,", ").concat(n.type," action"),$("<pre/>").text(r))}).delegate(".action","click",function(t){var e,o,i,a,u,l;return t.preventDefault(),(e=$(t.target)).is(".fork")&&null!=(a=e.data("slug"))?(f.context=[e.data("site")],n(t,a.split("_")[0])):(i=(o=$(this).parents(".page")).data("key"),l=c.atKey(i).getSlug(),(u=$(this).parent().children().not(".separator").index(e))<0?void 0:(t.shiftKey||o.nextAll().remove(),t.shiftKey||c.removeAllAfterKey(i),s.createPage("".concat(l,"_rev").concat(u),o.data("site")).appendTo($(".main")).each(function(t,e){return p.cycle($(e))}),r.set($(".page").last())))}).delegate(".fork-page","click",function(t){var n,r,o;if(!(n=$(t.target).parents(".page")).find(".future").length){if(o=c.atKey(n.data("key")),n.attr("id").match(/_rev0$/))return e(o,n);if(r={type:"fork"},n.hasClass("local")){if(f.useLocalStorage())return;n.removeClass("local")}else o.isRecycler()?n.removeClass("recycler"):o.isRemote()&&(r.site=o.getRemoteSite());return null!=n.data("rev")&&n.find(".revision").remove(),n.removeClass("ghost"),f.put(n,r)}}).delegate("button.create","click",function(t){return m($(t.target).data("slug"),function(e){var n,r,o;return(n=$(t.target).parents(".page:first")).removeClass("ghost"),(o=c.atKey(n.data("key"))).become(e),r=o.getRawPage(),p.rebuildPage(o,n.empty()),f.put(n,{type:"create",id:r.id,item:{title:r.title,story:r.story}})})}).delegate(".score","mouseenter mouseleave",function(t){return console.log("in .score..."),$(".main").trigger("thumb",$(t.target).data("thumb"))}).delegate("a.search","click",function(t){var e,n,r,o,i;return r=(e=$(t.target).parents(".page")).data("key"),o=c.atKey(r),(i=l()).setTitle("Search from '".concat(o.getTitle(),"'")),i.addParagraph("Search for pages related to '".concat(o.getTitle(),"'.\nEach search on this page will find pages related in a different way.\nChoose the search of interest. Be patient.")),i.addParagraph("Find pages with links to this title."),i.addItem({type:"search",text:"SEARCH LINKS ".concat(o.getSlug())}),i.addParagraph("Find pages with titles similar to this title."),i.addItem({type:"search",text:"SEARCH SLUGS ".concat(o.getSlug())}),i.addParagraph("Find pages neighboring  this site."),i.addItem({type:"search",text:"SEARCH SITES ".concat(o.getRemoteSite(location.host))}),i.addParagraph("Find pages sharing any of these items."),i.addItem({type:"search",text:"SEARCH ANY ITEMS ".concat(function(){var t,e,r,i;for(i=[],t=0,e=(r=o.getRawPage().story).length;t<e;t++)n=r[t],i.push(n.id);return i}().join(" "))}),t.shiftKey||e.nextAll().remove(),t.shiftKey||c.removeAllAfterKey(r),s.showResult(i)}).bind("dragenter",function(t){return t.preventDefault()}).bind("dragover",function(t){return t.preventDefault()}).bind("drop",a.dispatch({page:function(t){return s.doInternalLink(t.slug,null,t.site)},file:function(t){return b(t)}})),$(".provider input").click(function(){return $("footer input:first").val($(this).attr("data-provider")),$("footer form").submit()}),$("body").on("new-neighbor-done",function(t,e){return $(".page").each(function(t,e){return p.emitTwins($(e))})}),h=function(t){return new Promise(function(e,n){var r;return r=o(t),wiki.origin.get("".concat(r,".json"),function(n,o){return e({title:t,slug:r,type:"reference",text:(n?n.msg:null!=o?o.story[0].text:void 0)||""})})})},$("<span>&nbsp; ☰ </span>").css({cursor:"pointer"}).appendTo("footer").click(function(){var t,e,n,r,o,i,a,u,c,f;if((u=l()).setTitle("Selected Plugin Pages"),u.addParagraph("Installed plugins offer these utility pages:"),window.catalog){for(f=[],t=0,r=(i=window.catalog).length;t<r;t++)if((e=i[t]).pages)for(n=0,o=(a=e.pages).length;n<o;n++)c=a[n],f.push(c);return Promise.all(f.map(h)).then(function(t){return t.forEach(function(t){return u.addItem(t)}),s.showResult(u)})}}),$("<span>&nbsp; wiki <span class=editEnable>✔︎</span> &nbsp; </span>").css({cursor:"pointer"}).appendTo("footer").click(function(){return $(".editEnable").toggle(),$(".page").each(function(){var t,e;return t=$(this),e=c.atKey(t.data("key")),p.rebuildPage(e,t.empty())})}),isAuthenticated||$(".editEnable").toggle(),v.bind(),$(function(){var t,e;return g.first(),t=$(".page").toArray(),(e=function(t){var n;if(0!==t.length)return n=$(t.shift()),p.cycle(n).then(function(){return e(t)});r.set($(".page").last())})(t)})})},{"./active":3,"./dialog":6,"./drop":7,"./license":15,"./lineup":16,"./link":17,"./page":20,"./pageHandler":21,"./plugin":23,"./refresh":27,"./state":34,"./target":36}],15:[function(t,e,n){"use strict";var r,o,i,a,u;u=t("./resolve"),i=t("./lineup"),r=function(t,e){var n,r,o,i,a,u,c,s;if(null==t.journal)return"";for(r={},a=[],o=0,i=(u=t.journal.slice(0).reverse()).length;o<i;o++)null!=(n=u[o]).site&&(e=n.site),"fork"!==n.type&&null==r[e]&&(s=wiki.site(e).getDirectURL(""),c=wiki.site(e).flag(),a.push('<a href="'.concat(s,'" target="_blank"><img class="remote" title="').concat(e,'" src="').concat(c,'"> ').concat(e,"</a>")),r[e]=!0);return a.length>0?"<p>\n  Author's Sites:\n</p><p>\n  ".concat(a.join("<br>"),"\n</p>"):""},a=function(t){return null==(null!=t?t.provenance:void 0)?"":"<p>\n  Created From:\n</p><p>\n  ".concat(u.resolveLinks(t.provenance),"\n</p>")},o=function(t){var e,n,o;return e=(n=i.atKey(t.data("key"))).getRawPage(),o=n.getRemoteSite(location.hostname),'<p>\n  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">\n  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>\n</p><p>\n  This work is licensed under a\n  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">\n    Creative Commons Attribution-ShareAlike 4.0 International License\n  </a>.\n</p><p>\n  This license applies uniformly to all contributions\n  by all authors. Where authors quote other sources\n  they do so within the terms of fair use or other\n  compatiable terms.\n</p>'+r(e,o)+a(e.journal[0])},e.exports={info:o}},{"./lineup":16,"./resolve":28}],16:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f,d,h,p,g,v,m,y=[].indexOf;p=t("./random"),h={},f=[],r=function(t){var e;return e=p.randomBytes(4),h[e]=t,f.push(e),e},a=function(t,e){var n;return n=f.indexOf(t),f.splice(n,1),f.splice(e,0,t)},v=function(t){return y.call(f,t)<0?null:(f=f.filter(function(e){return t!==e}),delete h[t],t)},g=function(t){var e,n;if(e=[],y.call(f,t)<0)return e;for(;f[f.length-1]!==t;)n=f.pop(),e.unshift(n),delete h[n];return e},o=function(t){return h[t]},m=function(t){return o(t).getTitle()},i=function(){return f.length?m(f[f.length-1]):"Wiki"},c=function(){return f},s=function(){return h={},f=[]},l=function(t){if("".concat(f)!=="".concat(t)&&(console.log("The lineup is out of sync with the dom."),console.log(".pages:",t),console.log("lineup:",f),"".concat(Object.keys(f).sort())==="".concat(Object.keys(t).sort())))return console.log("It looks like an ordering problem we can fix."),t},d=function(t){var e;return(e=f.indexOf(t))<1?null:f[e-1]},u=function(t,e){var n,r,o,i,a,u;return r=(i=h[t]).getRemoteSite(e),a=["view",u=i.getSlug()],"welcome-visitors"!==u&&a.unshift("view","welcome-visitors"),r!==e&&null!=(o=d(t))&&((n=h[o]).isRemote()||a.push(e,n.getSlug())),a.unshift(r),a},e.exports={addPage:r,changePageIndex:a,removeKey:v,removeAllAfterKey:g,atKey:o,titleAtKey:m,bestTitle:i,debugKeys:c,debugReset:s,crumbs:u,debugSelfCheck:l}},{"./random":25}],17:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f,d;c=t("./lineup"),r=t("./active"),l=t("./refresh");var h=t("./page");i=h.asTitle,o=h.asSlug,s=h.pageEmitter,a=function(t,e){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e&&"view"!==e&&(r=e),o||(o=i(t)),n=$('<div class="page" id="'.concat(t,'" tabindex="-1">\n  <div class="paper">\n    <div class="twins"> <p> </p> </div>\n    <div class="header">\n      <h1> <img class="favicon" src="').concat(wiki.site(r).flag(),'" height="32px"> ').concat(o," </h1>\n    </div>\n  </div>\n</div>")),r&&n.data("site",r),n},f=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return a(t,e,n).appendTo(".main").each(function(t,e){return l.cycle($(e))})},u=function(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n=o(t),null!=e&&$(e).nextAll().remove(),null!=e&&c.removeAllAfterKey($(e).data("key")),f(n,i,t),r.set($(".page").last())},d=function(t){var e,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=o.$page&&$(o.$page).nextAll().remove(),null!=o.$page&&c.removeAllAfterKey($(o.$page).data("key")),n=t.getSlug(),null!=o.rev&&(n+="_rev".concat(o.rev)),(e=a(n).addClass("ghost")).appendTo($(".main")),l.buildPage(t,e),r.set($(".page").last())},s.on("show",function(t){return console.log("pageEmitter handling",t),d(t)}),e.exports={createPage:a,doInternalLink:u,showPage:f,showResult:d}},{"./active":3,"./lineup":16,"./page":20,"./refresh":27}],18:[function(t,e,n){"use strict";var r,o,i,a,u,c,s={}.hasOwnProperty;r=t("underscore"),i=t("minisearch"),e.exports=a={},a.sites={},u=0,c=function(t,e){var n,r,o;if(!e.sitemapRequestInflight)return e.sitemapRequestInflight=!0,o=function(t,e,n){return $('.neighbor[data-site="'.concat(t,'"]')).find("div").removeClass(e).addClass(n)},n=function(){return o(t,"wait","fetch"),wiki.site(t).get("system/sitemap.json",function(n,r){return e.sitemapRequestInflight=!1,n?(o(t,"fetch","fail"),wiki.site(t).refresh(function(){})):(e.sitemap=r,o(t,"fetch","done"),$("body").trigger("new-neighbor-done",t))}),wiki.site(t).getIndex("system/site-index.json",function(n,r){if(n)return console.log("error loading index",t,n);try{return e.siteIndex=i.loadJSON(r,{fields:["title","content"]}),console.log(t,"index loaded")}catch(e){return e,console.log("error loading index - not a valid index",t)}})},(r=Date.now())>u?(u=r+500,setTimeout(n,100)):(setTimeout(n,u-r),u+=500)},a.retryNeighbor=function(t){var e;return console.log("retrying neighbor"),e={},a.sites[t]=e,c(t,e)},a.registerNeighbor=function(t){var e;if(null==a.sites[t])return e={},a.sites[t]=e,c(t,e),$("body").trigger("new-neighbor",t)},a.updateSitemap=function(t){var e,n,r,o,i,u,c,s,l,f;if(u=location.host,(i=a.sites[u])&&!i.sitemapRequestInflight)return s=t.getSlug(),e=t.getDate(),f=t.getTitle(),l=t.getSynopsis(),o=t.getLinks(),n={slug:s,date:e,title:f,synopsis:l,links:o},(r=(c=i.sitemap).findIndex(function(t){return t.slug===s}))>=0?c[r]=n:c.push(n),$("body").trigger("new-neighbor-done",u)},a.deleteFromSitemap=function(t){var e,n,r,o,i;if(r=location.host,(n=a.sites[r])&&!n.sitemapRequestInflight&&(i=t.getSlug(),(e=(o=n.sitemap).findIndex(function(t){return t.slug===i}))>=0))return o.splice(e),$("body").trigger("delete-neighbor-done",r)},a.listNeighbors=function(){return r.keys(a.sites)},o=function(t,e){var n,r,o,i;switch(e.type){case"paragraph":case"markdown":t+=" "+e.text.replace(/\[{1,2}|\]{1,2}/g,"");break;case"html":t+=" "+e.text.replace(/<[^>]*>/g,"");break;default:if(null!=e.text)for(n=0,r=(i=e.text.split(/\r\n?|\n/)).length;n<r;n++)(o=i[n]).match(/^[A-Z]+[ ].*/)||(t+=" "+o.replace(/\[{1,2}|\]{1,2}/g,""))}return t},a.updateIndex=function(t,e){var n,r,i,u,c,s,l;if(console.log("updating ".concat(t.getSlug()," in index")),c=location.host,r=a.sites[c]){u=e.reduce(o,""),s=t.getSlug(),l=t.getTitle(),i=t.getRawPage().story.reduce(o,"");try{r.siteIndex.remove({id:s,title:l,content:u})}catch(t){(n=t).message.includes("not in the index")||console.log("removing ".concat(s," from index failed"),n)}return r.siteIndex.add({id:s,title:l,content:i})}},a.deleteFromIndex=function(t){var e,n,r,i,u,c;if(i=location.host,n=a.sites[i]){u=t.getSlug(),c=t.getTitle(),r=t.getRawPage().story.reduce(o,"");try{return n.siteIndex.remove({id:u,title:c,content:r})}catch(t){if(!(e=t).message.includes("not in the index"))return console.log("removing ".concat(u," from index failed"),e)}}},a.search=function(t){var e,n,r,o,u,c,l,f,d,h,p,g;for(u in n=[],h={},p=function(t){return null!=h[t]?h[t]++:h[t]=1},r=function(t,e){var n,r;return r="indexing sitemap ( ".concat(t," )"),console.time(r),console.log("indexing sitemap:",t),n=new i({fields:["title","content"]}),o.sitemap.forEach(function(t){n.add({id:t.slug,title:t.title,content:t.synopsis})}),console.timeEnd(r),n},d=Date.now(),l=a.sites)s.call(l,u)&&(o=l[u]).sitemap&&null==o.siteIndex&&(o.siteIndex=r(u));for(u in c=location.host,f=a.sites)if(s.call(f,u)&&(o=f[u]).siteIndex){p("sites");try{null!=h.pages?h.pages+=o.sitemap.length:h.pages=o.sitemap.length}catch(t){t,console.info("+++ sitemap not valid for ",u),o.sitemap=[]}u===c?(g=20,e=2):(g=10,e=1),o.siteIndex.search(t,{boost:{title:g,content:e},prefix:!0,combineWith:"AND"}).forEach(function(t){return p("finds"),n.push({page:o.sitemap.find(function(e){return e.slug===t.id}),site:u,rank:t.score})})}return n.sort(function(t,e){return e.rank-t.rank}),h.msec=Date.now()-d,{finds:n,tally:h}},a.backLinks=function(t){var e,n,r,o,i;for(r in e=[],o=a.sites)s.call(o,r)&&(n=o[r]).sitemap&&n.sitemap.forEach(function(n,o){if(null!=n.links&&Object.keys(n.links).length>0&&Object.keys(n.links).includes(t))return e.push({slug:n.slug,title:n.title,site:r,itemId:n.links[t],date:n.date})});return i={},e.forEach(function(e){return t=e.slug,i[t]=i[t]||{},i[t].title=e.title,i[t].sites=i[t].sites||[],i[t].sites.push({site:e.site,date:e.date,itemId:e.itemId})}),i}},{minisearch:57,underscore:64}],19:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f;u=t("./link"),f=t("./wiki"),c=t("./neighborhood"),s=null,l=0,i=function(t){return t.hasOwnProperty("links")},o=function(t){return console.log("neighbor - flag"),'<span class="neighbor" data-site="'.concat(t,'">\n  <div class="wait">\n    <img src="').concat(f.site(t).flag(),'" title="').concat(t,'">\n  </div>\n</span>')},a=function(t){return s=t.sites},r=function(){var t;return t=$(".neighborhood"),$("body").on("new-neighbor",function(e,n){return t.append(o(n))}).on("new-neighbor-done",function(t,e){var n,r;try{r=s[e].sitemap.length}catch(t){t,r=0}n=$('.neighborhood .neighbor[data-site="'.concat(e,'"]')).find("img");try{s[e].sitemap.some(i)?n.attr("title","".concat(e,"\n ").concat(r," pages with 2-way links")):n.attr("title","".concat(e,"\n ").concat(r," pages"))}catch(t){t,console.info("+++ sitemap not valid for ",e),s[e].sitemap=[]}return l+=r,$(".searchbox .pages").text("".concat(l," pages"))}).delegate(".neighbor img","click",function(t){var e;return $(t.target).parent().hasClass("fail")?($(t.target).parent().removeClass("fail").addClass("wait"),e=$(t.target).attr("title"),f.site(e).refresh(function(){return console.log("about to retry neighbor"),c.retryNeighbor(e)})):u.doInternalLink("welcome-visitors",null,this.title.split("\n")[0])})},e.exports={inject:a,bind:r}},{"./link":17,"./neighborhood":18,"./wiki":38}],20:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f,d;a=t("./util").formatDate,l=t("./random"),f=t("./revision"),d=t("./synopsis"),r=t("underscore"),s=new(0,t("events").EventEmitter),o=function(t){return t.replace(/\s/g,"-").replace(/[^A-Za-z0-9-]/g,"").toLowerCase()},i=function(t){return t.replace(/-/g," ")},c=function(t){return[{symbol:"❄",date:t-316224e5,period:"a Year"},{symbol:"⚘",date:t-80352e5,period:"a Season"},{symbol:"⚪",date:t-26784e5,period:"a Month"},{symbol:"☽",date:t-6048e5,period:"a Week"},{symbol:"☀",date:t-864e5,period:"a Day"},{symbol:"⌚",date:t-36e5,period:"an Hour"}]},u=function(t,e){var n,i,s,h,p,g,v,m;return(m=t||{}).title||(m.title="empty"),m.story||(m.story=[]),m.journal||(m.journal=[]),v=function(t,e){var n,r,o;for(r=0,o=t.length;r<o;r++)if((n=t[r]).id===e.id&&n.date===e.date)return!1;return!0},{getRawPage:function(){return m},getContext:function(){var t,n,o,i,a,u;for(o=["view"],g()&&o.push(e),n=function(t){if(null!=t&&!r.include(o,t))return o.push(t)},i=0,a=(u=m.journal.slice(0).reverse()).length;i<a;i++)n(null!=(t=u[i])?t.site:void 0);return o},isPlugin:p=function(){return null!=m.plugin},isRemote:g=function(){return!(void 0===e||null===e||"view"===e||"origin"===e||"local"===e||"recycler"===e)},isLocal:function(){return"local"===e},isRecycler:function(){return"recycler"===e},getRemoteSite:i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return g()?e:t},getRemoteSiteDetails:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t=[],(e||g())&&t.push(i(e)),p()&&t.push("".concat(m.plugin," plugin")),t.join("\n")},getSlug:h=function(){return o(m.title)},getNeighbors:function(t){var n,o,i,a,u,c,s,l,f;for(s=[],g()?s.push(e):null!=t&&s.push(t),i=0,u=(l=m.story).length;i<u;i++)null!=(null!=(o=l[i])?o.site:void 0)&&s.push(o.site);for(a=0,c=(f=m.journal).length;a<c;a++)null!=(null!=(n=f[a])?n.site:void 0)&&s.push(n.site);return r.uniq(s)},getTitle:function(){return m.title},getLinks:function(){var t,e,n;e=function(t,e,n,r){var i,a,u;try{for(a=/\[\[([^\]]+)\]\]/g,u=void 0;null!==(u=a.exec(e.text));)t.has(o(u[1]))||t.set(o(u[1]),e.id)}catch(t){i=t,console.log("*** Error extracting links from ".concat(n," of ").concat(JSON.stringify(r)),i.message)}return t};try{n=m.story.reduce(e,new Map)}catch(e){t=e,console.log("+++ Extract links on ".concat(m.slug," fails"),t)}return n.size>0?Object.fromEntries(n):{}},setTitle:function(t){return m.title=t},getRevision:s=function(){return m.journal.length-1},getDate:function(){var t;if(null!=(t=m.journal[s()])&&null!=t.date)return t.date},getTimestamp:function(){var t;return null!=(t=m.journal[s()])?null!=t.date?a(t.date):"Revision ".concat(s()):"Unrecorded Date"},getSynopsis:function(){return d(m)},addItem:n=function(t){return t=r.extend({},{id:l.itemId()},t),m.story.push(t)},getItem:function(t){var e,n,r,o;for(n=0,r=(o=m.story).length;n<r;n++)if((e=o[n]).id===t)return e;return null},addParagraph:function(t){return"paragraph",n({type:"paragraph",text:t})},seqItems:function(t){return new Promise(function(e,n){var r;return(r=function(n){return n>=m.story.length?e():t(m.story[n]||{text:"null"},function(){return r(n+1)})})(0)})},seqActions:function(t){var e,n,r;return r=0,n=c((new Date).getTime()),(e=function(o){var i,a,u,c,s,l;if(!(o>=m.journal.length)){for(a=(i=m.journal[o]||{}).date||0,l=null,u=0,c=n.length;u<c;u++)(s=n[u]).date>r&&s.date<a&&(l=s);return r=a,t({action:i,separator:l},function(){return e(o+1)})}})(0)},become:function(t,e){if(m.story=(null!=t?t.getRawPage().story:void 0)||[],null!=e)return m.journal=null!=e?e.getRawPage().journal:void 0},siteLineup:function(){var t,n;return t="welcome-visitors"===(n=h())?"view/welcome-visitors":"view/welcome-visitors/view/".concat(n),g()?wiki.site(e).getDirectURL(t):"/".concat(t)},merge:function(t){var n,r,o,i,a;for(i=function(){var t,e,r,o;for(o=[],t=0,e=(r=m.journal).length;t<e;t++)n=r[t],o.push(n);return o}(),r=0,o=(a=t.getRawPage().journal).length;r<o;r++)n=a[r],v(m.journal,n)&&i.push(n);return i.push({type:"fork",site:t.getRemoteSite(),date:(new Date).getTime()}),u(f.create(999,{title:m.title,journal:i}),e)},apply:function(t){if(f.apply(m,t),t.site)return e=null},getCreate:function(){var t;return t=function(t){return"create"===t.type},m.journal.reverse().find(t)}}},e.exports={newPage:u,asSlug:o,asTitle:i,pageEmitter:s}},{"./random":25,"./revision":29,"./synopsis":35,"./util":37,events:48,underscore:64}],21:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f,d,h,p,g;r=t("underscore"),g=t("./state"),p=t("./revision"),o=t("./addToJournal"),c=t("./page").newPage,t("./random"),a=t("./lineup"),u=t("./neighborhood"),e.exports=l={},i=function(t){return JSON.parse(JSON.stringify(t))},l.useLocalStorage=function(){return $(".login").length>0},s=function(t){var e;return(e=localStorage.getItem(t))?JSON.parse(e):void 0},h=function(t){var e,n,r,o,i=t.pageInformation,a=t.whenGotten,u=t.whenNotGotten,s=t.localContext;return o=i.slug,n=i.rev,r=i.site,e={get:function(t,e){return wiki.local.get(t,function(n,o){return console.log([n,o]),null!=n?wiki.origin.get(t,e):(r="local",e(null,o))})}},r?s=[]:r=s.shift(),r===window.location.host&&(r="origin"),null===r&&(r="view"),function(){switch(r){case"local":return wiki.local;case"origin":return wiki.origin;case"recycler":return wiki.recycler;case"view":return e;default:return wiki.site(r)}}().get("".concat(o,".json"),function(t,e){var o,l,f;return t?404===t.xhr.status||0===t.xhr.status?s.length>0?h({pageInformation:i,whenGotten:a,whenNotGotten:u,localContext:s}):u():(l="The page handler has run into problems with this request.\n<pre class=error>".concat(JSON.stringify(i),"</pre>\nThe requested url.\n<pre class=error>").concat(url,"</pre>\nThe server reported status.\n<pre class=error>").concat(null!=(o=t.xhr)?o.status:void 0,"</pre>\nThe error message.\n<pre class=error>").concat(t.msg,"</pre>\nThese problems are rarely solved by reporting issues.\nThere could be additional information reported in the browser's console.log.\nMore information might be accessible by fetching the page outside of wiki.\n<a href=\"").concat(url,'" target="_blank">try-now</a>'),(f=c({title:"Trouble: Can't Get Page"},null)).addItem({type:"html",text:l}),a(f)):(console.log("got",r,e),n&&(e=p.create(n,e)),a(c(e,r)))})},l.get=function(t){var e,n=t.whenGotten,o=t.whenNotGotten,i=t.pageInformation;return!i.site&&(e=s(i.slug))?(i.rev&&(e=p.create(i.rev,e)),n(c(e,"local"))):(l.context.length||(l.context=["view"]),h({pageInformation:i,whenGotten:n,whenNotGotten:o,localContext:r.clone(l.context)}))},l.context=[],f=function(t,e,n){var r,i;return"create"===n.type?r={title:n.item.title,story:[],journal:[]}:((r=s(e.slug))||(r=a.atKey(t.data("key")).getRawPage()),null==r.journal&&(r.journal=[]),null!=(i=n.fork)&&(r.journal=r.journal.concat({type:"fork",site:i,date:(new Date).getTime()}),delete n.fork)),p.apply(r,n),wiki.local.put(e.slug,r,function(){return o(t.find(".journal"),n),t.addClass("local")})},d=function(t,e,n){var r,c;return r=i(n),c=a.atKey(t.data("key")),"fork"===n.type&&(r.item=i(c.getRawPage())),wiki.origin.get("".concat(e.slug,".json"),function(i,a){var s;return s=i?[]:a.story||[],wiki.origin.put(e.slug,r,function(r){return r?(n.error={type:r.type,msg:r.msg,response:r.xhr.responseText},f(t,e,n)):((null!=c?c.apply:void 0)&&c.apply(n),u.updateSitemap(c),u.updateIndex(c,s),o(t.find(".journal"),n),"fork"===n.type?wiki.local.delete(t.attr("id")):void 0)})})},l.put=function(t,e){var n,r,i;return n=function(){var e;switch(e=t.data("site")){case"origin":case"local":case"view":case location.host:return null;default:return e}},r=(i={slug:t.attr("id").split("_rev")[0],rev:t.attr("id").split("_rev")[1],site:n(),local:t.hasClass("local")}).site,console.log("pageHandler.put",e,i),l.useLocalStorage()&&(null!=i.site?console.log("remote => local"):i.local||(console.log("origin => local"),e.site=r=location.host)),e.date=(new Date).getTime(),"origin"===e.site&&delete e.site,t.removeClass("plugin"),r&&(t.find("h1").prop("title",location.host),t.find("h1 img").attr("src","/favicon.png"),t.find("h1 a").attr("href","/view/welcome-visitors/view/".concat(i.slug)).attr("target",location.host),t.data("site",null),t.removeClass("remote"),g.setUrl(),"fork"!==e.type&&(e.fork=r,o(t.find(".journal"),{type:"fork",site:r,date:e.date}))),l.useLocalStorage()||"local"===i.site?f(t,i,e):d(t,i,e)},l.delete=function(t,e,n){return console.log("delete server-side"),console.log("pageObject:",t),t.isRecycler()?wiki.recycler.delete("".concat(t.getSlug(),".json"),function(t){return setTimeout(function(){return n(t)},300)}):wiki.origin.delete("".concat(t.getSlug(),".json"),function(e){return setTimeout(function(){return null==e&&u.deleteFromSitemap(t),null==e&&u.deleteFromIndex(t),n(e)},300)})}},{"./addToJournal":4,"./lineup":16,"./neighborhood":18,"./page":20,"./random":25,"./revision":29,"./state":34,underscore:64}],22:[function(t,e,n){"use strict";var r,o,i,a,u,c;o=t("./editor"),u=t("./resolve"),a=t("./itemz"),c=function(t){return t.match(/<(i|b|p|a|h\d|hr|br|li|img|div|span|table|blockquote)\b.*?>/i)?"html":"markdown"},i=function(t,e){var n,r,o,i,a;for(i=[],n=0,r=(o=e.text.split(/\n\n+/)).length;n<r;n++)(a=o[n]).match(/\S/)?i.push(t.append("<p>".concat(u.resolveLinks(a),"</p>"))):i.push(void 0);return i},r=function(t,e){return t.dblclick(function(n){return n.shiftKey?(e.type=c(e.text),a.replaceItem(t,"paragraph",e)):o.textEditor(t,e,{append:!0})})},e.exports={emit:i,bind:r}},{"./editor":8,"./itemz":13,"./resolve":28}],23:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f=[].indexOf;e.exports=s={},i=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},u=function(t,e){return console.log("loading url:",t),e=$.extend(e||{},{dataType:"script",cache:!0,url:t}),$.ajax(e)},l=[],c={},a=s.getScript=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return f.call(l,t)>=0?e():u(t).done(function(){return l.push(t),e()}).fail(function(n,r,o){return console.log("getScript: Failed to load:",t,o),e()})},s.renderFrom=function(t){var e,n,r;return e=$(".item").slice(t),console.log("notifIndex",t,"about to render",e.toArray()),r=Promise.resolve(),n=function(t){var e,o,i;return 0===t.length?r:(i=t.shift(),(e=$(i)).hasClass("textEditing")||(o=e.data("item"),r=r.then(function(){return new Promise(function(t,n){return e.off(),s.emit(e.empty(),o,function(){return t()})})})),n(t))},r=(r=n(e.toArray())).then(function(){var t;return r=Promise.resolve(),(t=function(e){var n,o,i;return 0===e.length?r:(i=e.shift(),n=$(i),o=n.data("item"),r=r.then(function(){return new Promise(function(t,e){return s.getPlugin(o.type,function(e){return e.bind(n,o),t()})})}),t(e))})(e.toArray())})},o=function(t){return function(e,n){return e.addClass("emit"),t(e,n)}},r=function(t,e){return function(n,r,o){var i,a,u,c;return n[0].consuming=[],u=$(".item").index(n),i=window.plugins[t].consumes,c=Promise.resolve(),i&&(a=[],i.forEach(function(e){var r;return r=$(".item:lt(".concat(u,")")).filter(e),console.log(t,"consumes",e),console.log(r,"produce",e),r&&0!==r.length||console.log("warn: no items in lineup that produces",e),console.log("there are ".concat(r.length," instances of ").concat(e)),r.each(function(t,e){var r,o;return o=$(e).parents(".page").data("key"),r=$(e).attr("data-id"),n[0].consuming.push("".concat(o,"/").concat(r)),a.push(e.promise)})}),c=Promise.all(a)),c.then(function(){var t;return n.removeClass("emit"),(t=e(n,r))&&"function"!=typeof t.then||(t=Promise.resolve(t)),n[0].promise=t}).catch(function(t){return console.log("plugin emit: unexpected error",t)})}},s.wrap=function(t,e){return e.emit=o(e.emit),e.bind=r(t,e.bind),e},s.get=s.getPlugin=function(t,e){return c[t]?c[t].then(e):(c[t]=new Promise(function(e,n){return window.plugins[t]?e(window.plugins[t]):a("/plugins/".concat(t,"/").concat(t,".js"),function(){var n;return(n=window.plugins[t])?(s.wrap(t,n),e(n)):a("/plugins/".concat(t,".js"),function(){return(n=window.plugins[t])&&s.wrap(t,n),e(n)})})}),c[t].then(function(n){return delete c[t],e(n)}),c[t])},s.do=s.doPlugin=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return t.data("item",e),s.renderFrom($(".item").index(t)).then(function(){return n()})},s.emit=function(t,e){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return n=function(n,r){return t.append('<div class="error">\n  '.concat(i(e.text||""),"\n  <button>help</button><br>\n</div>")),null!=e.text&&t.find(".error").dblclick(function(n){return wiki.textEditor(t,e)}),t.find("button").on("click",function(){return wiki.dialog(n.toString(),'<p> This "'.concat(e.type,'" plugin won\'t show.</p>\n<li> Is it available on this server?\n<li> Is its markup correct?\n<li> Can it find necessary data?\n<li> Has network access been interrupted?\n<li> Has its code been tested?\n<p> Developers may open debugging tools and retry the plugin.</p>\n<button class="retry">retry</button>\n<p> Learn more\n  <a class="external" target="_blank" rel="nofollow"\n  href="http://plugins.fed.wiki.org/about-plugins.html"\n  title="http://plugins.fed.wiki.org/about-plugins.html">\n    About Plugins\n    <img src="/images/external-link-ltr-icon.png">\n  </a>\n</p>')),$(".retry").on("click",function(){return r.emit.length>2?r.emit(t,e,function(){return o()}):(r.emit(t,e),o())})})},t.data("pageElement",t.parents(".page")),t.data("item",e),s.get(e.type,function(i){var a;try{if(null==i)throw TypeError("Can't find plugin for '".concat(e.type,"'"));return i.emit.length>2?i.emit(t,e,function(){return r&&i.bind(t,e),o()}):(i.emit(t,e),o())}catch(t){return a=t,console.log("plugin error",a),n(a,i),o()}})},s.registerPlugin=function(t,e){return window.plugins[t]=e($)}},{}],24:[function(t,e,n){"use strict";var r;r=t("./plugin"),window.plugins={reference:r.wrap("reference",t("./reference")),factory:r.wrap("factory",t("./factory")),paragraph:r.wrap("paragraph",t("./paragraph")),image:r.wrap("image",t("./image")),future:r.wrap("future",t("./future")),importer:r.wrap("importer",t("./importer"))}},{"./factory":9,"./future":10,"./image":11,"./importer":12,"./paragraph":22,"./plugin":23,"./reference":26}],25:[function(t,e,n){"use strict";var r,o,i;o=function(){return(256*(1+Math.random())|0).toString(16).substring(1)},i=function(t){return function(){var e,n,r;for(r=[],e=1,n=t;1<=n?e<=n:e>=n;1<=n?e++:e--)r.push(o());return r}().join("")},r=function(){return i(8)},e.exports={randomByte:o,randomBytes:i,itemId:r}},{}],26:[function(t,e,n){"use strict";var r,o,i,a,u;o=t("./editor"),u=t("./resolve"),a=t("./page"),i=function(t,e){var n,r;return r=e.slug,null!=e.title&&(r||(r=a.asSlug(e.title))),r||(r="welcome-visitors"),n=e.site,u.resolveFrom(n,function(){return t.append("<p>\n  <img class='remote'\n    src='".concat(wiki.site(n).flag(),"'\n    title='").concat(n,"'\n    data-site=\"").concat(n,'"\n    data-slug="').concat(r,'"\n  >\n  ').concat(u.resolveLinks("[[".concat(e.title||r,"]]")),"\n  —\n  ").concat(u.resolveLinks(e.text),"\n</p>"))})},r=function(t,e){return t.dblclick(function(){return o.textEditor(t,e)})},e.exports={emit:i,bind:r}},{"./editor":8,"./page":20,"./resolve":28}],27:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i,a,u,c,s,l,f,d,h,p,g,v,m,y,b,w,x,k,_,I,j,S,A,E,C,O,T,F,L,P,D,R,N,M,B,z,U,q,K,W;i=t("underscore"),N=t("./pageHandler"),B=t("./plugin"),W=t("./state"),L=t("./neighborhood"),u=t("./addToJournal"),a=t("./actionSymbols"),F=t("./lineup"),K=t("./resolve"),z=t("./random"),M=t("./page"),D=M.newPage,s=M.asSlug,R=M.pageEmitter,_=function(t){if($(t).length>0)return $(t).data("item")||$(t).data("staticItem")},c=function(t,e,n){var r,o;return r=$.extend({},n),null!=(o=F.atKey(t.data("key"))).getItem(r.id)?(r.alias||(r.alias=r.id),r.id=z.itemId(),e.attr("data-id",r.id),e.data("id",r.id),e.data("item").id=r.id):null!=r.alias&&null==o.getItem(r.alias)&&(r.id=r.alias,delete r.alias,e.attr("data-id",r.id)),r},k=function(t,e){return t&&e&&t.get(0)===e.get(0)},j=function(t){return t.children().map(function(t,e){return $(e).attr("data-id")}).get()},S=function(t,e,n,r){var o,a,u,s,l,f,d,h,p,g,v,m;if(u=e.item,h=_(u),m=(s=u.data("pageElement")).hasClass("ghost")||s.hasClass("remote"),f=(a=u.parents(".page:first")).hasClass("ghost"),p=!(g=k(s,a))&&s.attr("id")===a.attr("id"),!f&&!p)return g?(v=j(u.parents(".story:first")),void(i.isEqual(v,r)||($(".shadow-copy").remove(),u.empty(),n<(d=$(".item").index(u))&&(d=n),B.renderFrom(d),N.put(a,{id:h.id,type:"move",order:v})))):(m||t.shiftKey?$(".shadow-copy").removeClass("shadow-copy").data(u.data()).attr({"data-id":u.attr("data-id")}):N.put(s,{id:h.id,type:"remove"}),u.data("pageElement",a),o=u.prev(".item"),l=_(o),h=c(a,u,h),N.put(a,{id:h.id,type:"add",item:h,after:null!=l?l.id:void 0}),$(".shadow-copy").remove(),u.empty(),o.after(u),n<(d=$(".item").index(u))&&(d=n),B.renderFrom(d));$(t.target).sortable("cancel")},f=function(t,e){var n,r,o,i,a,u,c;return c=(r=e.item.data("pageElement")).hasClass("ghost")||r.hasClass("remote"),i=(n=e.placeholder.parents(".page:first")).hasClass("ghost"),a=!(u=k(r,n))&&r.attr("id")===n.attr("id"),o=c||t.shiftKey&&!u,i||a?($("body").css("cursor","no-drop"),$(".shadow-copy").hide()):o?($("body").css("cursor","copy"),$(".shadow-copy").show()):($("body").css("cursor","move"),$(".shadow-copy").hide())},O=function(t){var e,n,r,o,i,a,u;return i=$("body").css("cursor"),o={connectWith:".page .story",placeholder:"item-placeholder",forcePlaceholderSize:!0,delay:150},e=t.find(".story"),u=null,a=null,r=null,n=function(t){if(27===t.which)return r=!0,e.sortable("cancel")},e.sortable(o).on("sortstart",function(t,o){var i;return i=o.item,u=j(e),a=$(".item").index(i),r=!1,$("body").on("keydown",n),i.clone().insertAfter(o.placeholder).hide().addClass("shadow-copy").css({width:"",height:"",position:"",zIndex:""}).removeAttr("data-id")}).on("sort",f).on("sortstop",function(t,e){return $("body").css("cursor",i).off("keydown",n),r||S(t,e,a,u),$(".shadow-copy").remove()})},I=function(t){var e;return e=$(t).parents(".page:first"),F.atKey(e.data("key"))},E=function(t,e){var n,r;return n=I(e.draggable),r=I(t.target),R.emit("show",r.merge(n))},T=function(t){var e;return(e=t.find(".journal")).draggable({revert:!0,appendTo:".main",scroll:!1,helper:"clone"}),e.droppable({hoverClass:"ui-state-hover",drop:E,accept:".journal"})},C=function(t){return t.find(".add-factory").on("click",function(e){if(!t.hasClass("ghost"))return e.preventDefault(),d(t)})},d=function(t){var e,n,r,o;return o={type:"factory",id:z.itemId()},(n=$("<div />",{class:"item factory"}).data("item",o).attr("data-id",o.id)).data("pageElement",t),t.find(".story").append(n),B.do(n,o),e=n.prev(".item"),r=_(e),N.put(t,{item:o,id:o.id,type:"add",after:null!=r?r.id:void 0})},A=function(t){var e,n,o,i,a;return t.preventDefault(),F.debugSelfCheck(function(){var t,e,n,r;for(r=[],t=0,e=(n=$(".page")).length;t<e;t++)o=n[t],r.push($(o).data("key"));return r}()),e=$(t.target).parents(".page:first"),a=r(n=F.crumbs(e.data("key"),location.host),1)[0],""===(i=r(wiki.site(a).getDirectURL("").split("/"),1)[0])&&(i=window.location.protocol),window.open("".concat(i,"//").concat(n.join("/")),a).focus()},b=function(t,e,n){var r,o;return r=n.isRecycler()?"recycler":n.getRemoteSite(location.host),o=n.getRemoteSiteDetails(location.host),t.append('<h1 title="'.concat(o,'">\n  <span>\n    <a href="').concat(n.siteLineup(),'" target="').concat(r,'">\n      <img src="').concat(wiki.site(r).flag(),'" height="32px" class="favicon"></a>\n    ').concat(K.escape(n.getTitle()),"\n  </span>\n</h1>")),t.find("a").on("click",A)},w=function(t,e,n){if(e.attr("id").match(/_rev/))return e.addClass("ghost"),e.data("rev",n.getRevision()),t.append($('<h2 class="revision">\n  <span>\n    '.concat(n.getTimestamp(),"\n  </span>\n</h2>")))},m=function(t){return t.append('<div class="control-buttons">\n  <a href="#" class="button fork-page" title="fork this page">'.concat(a.fork,'</a>\n  <a href="#" class="button add-factory" title="add paragraph">').concat(a.add,"</a>\n</div>"))},v=function(t,e){var n,r,o,i,a,u,c,s,l,f,d,h,p,g;if(g=e.getSlug(),r=L.backLinks(g),Object.keys(r).length>0){for(l in f=[],r){for((n=r[l]).sites.sort(function(t,e){return(t.date||0)<(e.date||0)}),o=[],i=a=0,c=(d=n.sites).length;a<c;i=++a)p=d[i],i<10?(u=(null!=(h=n.sites[i-1])?h.date:void 0)===p.date?"":" ",o.unshift(u),o.unshift('<img class="remote"\n    src="'.concat(wiki.site(p.site).flag(),'"\n    data-slug="').concat(l,'"\n    data-site="').concat(p.site,'"\n    data-id="').concat(p.itemId,'"\n    title="').concat(p.site,"\n").concat(wiki.util.formatElapsedTime(p.date),'">'))):10===i&&o.unshift(" ⋯ ");s=K.resolveLinks("[[".concat(n.title,"]]")),f.push('<div style="clear: both;">\n  <div style="float: left;">'.concat(s,'</div>\n  <div style="text-align: right;"> ').concat(o.join("")," </div>\n</div>"))}if(f)return t.append("<details>\n  <summary>".concat(f.length," pages link here:</summary>\n  ").concat(f.join("\n"),"\n</details>"))}},y=function(t,e){var n,r;return n=e.getRemoteSite(location.host),r=e.getSlug(),t.append('<a class="show-page-license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> .\n<a class="show-page-source" href="'.concat(wiki.site(n).getDirectURL(r),'.json" title="source">JSON</a> .\n<a href= "').concat(wiki.site(n).getDirectURL(r),'.html" date-slug="').concat(r,'" target="').concat(n,'">').concat(n,' </a> .\n<a href= "#" class=search>search</a>'))},g=function(t){var e,n,r;for(n=(r=t||[]).length-1;n>=0;n+=-1)if((e=r[n]).date&&"fork"!==e.type)return e.date},x=function(t){var e,n,r,o,i,a,u,c,l,f,d,h,p,v,m,y,b;if((f=t.data("data"))&&("view"!==(v=t.data("site")||window.location.host)&&"origin"!==v||(v=window.location.host),m=s(f.title),b=g(f.journal))){for(p in n={newer:[],same:[],older:[]},d=L.sites)if(i=d[p],p!==v&&null!=i.sitemap)for(u=0,l=(h=i.sitemap).length;u<l;u++)(a=h[u]).slug===m&&(e=a.date>b?n.newer:a.date<b?n.older:n.same).push({remoteSite:p,item:a});for(c in y=[],n)(e=n[c]).length&&(e.sort(function(t,e){return t.item.date<e.item.date}),r=function(){var t,n,r;for(r=[],o=t=0,n=e.length;t<n;o=++t){var i=e[o];if(p=i.remoteSite,a=i.item,o>=8)break;r.push('<img class="remote"\nsrc="'.concat(wiki.site(p).flag(),'"\ndata-slug="').concat(m,'"\ndata-site="').concat(p,'"\ntitle="').concat(p,'">'))}return r}(),y.push("".concat(r.join("&nbsp;")," ").concat(c)));if(y)return t.find(".twins").html("<p><span>".concat(y.join(", "),"</span></p>"))}},q=function(t,e){var n,o,i,a,c,s,l,f,d,h;e.data("data",t.getRawPage()),t.isRemote()&&e.data("site",t.getRemoteSite()),console.log(".page keys ",function(){var t,e,n,r;for(r=[],t=0,e=(n=$(".page")).length;t<e;t++)d=n[t],r.push($(d).data("key"));return r}()),console.log("lineup keys",F.debugKeys()),K.resolutionContext=t.getContext(),e.empty(),l=$("<div class='paper' />"),e.append(l);var p=r(["handle-parent","twins","header","story","backlinks","journal","footer"].map(function(t){if("journal"!==t||$(".editEnable").is(":visible"))return $("<div />").addClass(t).appendTo(l)}),7);return i=p[0],p[1],a=p[2],f=p[3],n=p[4],c=p[5],o=p[6],s=$("<div />").addClass("page-handle").appendTo(i),b(a,0,t),w(a,e,t),h=(h=t.seqItems(function(t,e){var n;return n=$('<div class="item '.concat(t.type,'" data-id="').concat(t.id,'">')),f.append(n),n.data("item",t),e()})).then(function(){var t,n;return t=$(".page").index(e[0]),n=$(".item").index($($(".page")[t]).find(".item")),B.renderFrom(n)}).then(function(){return e}),$(".editEnable").is(":visible")&&t.seqActions(function(t,e){return t.separator&&u(c,t.separator),u(c,t.action),e()}),x(e),v(n,t),$(".editEnable").is(":visible")&&m(c),y(o,t),s.css({height:"".concat(f.position().top-i.position().top-5,"px")}),h},h=function(t,e){if(!e.isRemote())return $("img.favicon",t).on("error",function(){return B.get("favicon",function(t){return t.create()})})},U=function(t,e){var n;return t.isLocal()&&e.addClass("local"),t.isRecycler()&&e.addClass("recycler"),t.isRemote()&&e.addClass("remote"),t.isPlugin()&&e.addClass("plugin"),n=q(t,e),h(e,t),W.setUrl(),$(".editEnable").is(":visible")&&(O(e),T(e),C(e)),n},l=function(t,e){return e.data("key",F.addPage(t)),U(t,e)},P=function(t,e){var n,r,o,a,u,c,l,f,d,h;for(d in h=s(t),(c=D()).setTitle(t),r=[],l=L.sites)null!=(o=l[d]).sitemap&&null!=(f=i.find(o.sitemap,function(t){return t.slug===h}))&&r.push({type:"reference",site:d,slug:h,title:f.title||h,text:f.synopsis||""});if(r.length>0)for(c.addItem({type:"future",text:"We could not find this page in the expected context.",title:t,create:e}),c.addItem({type:"paragraph",text:"We did find the page in your current neighborhood."}),a=0,u=r.length;a<u;a++)n=r[a],c.addItem(n);else c.addItem({type:"future",text:"We could not find this page.",title:t,create:e});return c},p=function(t){var e;return e=new Promise(function(n,o){var i,a,u,c,s,f,d=r(t.attr("id").split("_rev"),2);return u=d[0],a=d[1],c=t.find(".header h1").text().trim(),i={slug:u,rev:a,site:t.data("site")},f=function(){var r,o,i,a;return o=$('a.internal[href="/'.concat(u,'.html"]:last')),c=c||o.text()||u,r=o.parents(".page").data("key"),null!=(a=F.atKey(r))?a.getCreate():void 0,i=P(c),(e=l(i,t)).then(function(t){return t.addClass("ghost")}),n(e)},s=function(r){var o,i,a,u;for(e=l(r,t),o=0,i=(a=r.getNeighbors(location.host)).length;o<i;o++)u=a[o],L.registerNeighbor(u);return n(e)},N.get({whenGotten:s,whenNotGotten:f,pageInformation:i})})},e.exports={cycle:p,emitTwins:x,buildPage:l,rebuildPage:U,newFuturePage:P}},{"./actionSymbols":2,"./addToJournal":4,"./lineup":16,"./neighborhood":18,"./page":20,"./pageHandler":21,"./plugin":23,"./random":25,"./resolve":28,"./state":34,underscore:64}],28:[function(t,e,n){"use strict";var r,o,i;r=t("./page").asSlug,e.exports=i={},i.resolutionContext=[],i.escape=o=function(t){return(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},i.resolveFrom=function(t,e){i.resolutionContext.push(t);try{return e()}finally{i.resolutionContext.pop()}},i.resolveLinks=function(t){var e,n,a,u,c,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return u=[],a=function(t){var e;return e=u.length,u.push(t),"〖".concat(e,"〗")},c=function(t,e){return u[+e]},n=function(t,e){var n;return(n=r(e)).length?a('<a class="internal" href="/'.concat(n,'.html" data-page-name="').concat(n,'" title="').concat(i.resolutionContext.join(" => "),'">').concat(o(e),"</a>")):t},e=function(t,e,n,r){return a('<a class="external" target="_blank" href="'.concat(e,'" title="').concat(e,'" rel="nofollow">').concat(o(r),' <img src="/images/external-link-ltr-icon.png"></a>'))},s(t=(t||"").replace(/〖(\d+)〗/g,"〖 $1 〗").replace(/\[\[([^\]]+)\]\]/gi,n).replace(/\[((http|https|ftp):.*?) (.*?)\]/gi,e)).replace(/〖(\d+)〗/g,c)}},{"./page":20}],29:[function(t,e,n){"use strict";var r,o;r=function(t,e){var n,r,o,i,a,u;switch(a=function(){var e,n,r,o,i;for(i=[],e=0,r=(o=t.story||[]).length;e<r;e++)n=o[e],i.push(null!=n?n.id:void 0);return i},n=function(e,n){var r;return r=a().indexOf(e)+1,t.story.splice(r,0,n)},u=function(){var n;if(-1!==(n=a().indexOf(e.id)))return t.story.splice(n,1)},t.story||(t.story=[]),e.type){case"create":null!=e.item&&(null!=e.item.title&&(t.title=e.item.title),null!=e.item.story&&(t.story=e.item.story.slice()));break;case"add":n(e.after,e.item);break;case"edit":-1!==(o=a().indexOf(e.id))?t.story.splice(o,1,e.item):t.story.push(e.item);break;case"move":o=e.order.indexOf(e.id),r=e.order[o-1],i=t.story[a().indexOf(e.id)],u(),n(r,i);break;case"remove":u()}return t.journal||(t.journal=[]),t.journal.push(e)},o=function(t,e){var n,o,i,a,u;for(t=+t,a=e.journal.slice(0,+t+1||9e9),u={title:e.title,story:[]},o=0,i=a.length;o<i;o++)n=a[o],r(u,n||{});return u},e.exports={create:o,apply:r}},{}],30:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f;s=t("./pageHandler"),l=t("./random"),a=t("./link"),t("./active"),u=t("./page").newPage,f=t("./resolve"),c=t("./page"),o=function(t,e){var n,r;return r=e.slug,null!=e.title&&(r||(r=c.asSlug(e.title))),r||(r="welcome-visitors"),n=e.site,f.resolveFrom(n,function(){return t.append("<p>\n  <img class='remote'\n    src='".concat(wiki.site(n).flag(),"'\n    title='").concat(n,"'\n    data-site=\"").concat(n,'"\n    data-slug="').concat(r,'"\n  >\n  ').concat(f.resolveLinks("[[".concat(e.title||r,"]]")),"\n  —\n  ").concat(f.resolveLinks(e.text),"\n</p>"))})},i=function(t,e){return t.preventDefault(),t.shiftKey||(c=$(t.target).parents(".page")),a.doInternalLink(e,c,$(t.target).data("site")),!1},r=function(t){var e=t.neighborhood;return{incrementalSearch:function(t){var n,r,a,u,c,f,d,h,p,g,v,m,y,b;if(!(t.length<2)){for(0===$(".incremental-search").length&&(h=$(".searchbox").position(),$("<div/>").css("left","".concat(h.left,"px")).css("bottom","".concat(h.top+$(".searchbox").height(),"px")).addClass("incremental-search").delegate(".internal","click",function(t){var e;return"SPAN"===t.target.nodeName&&(t.target=$(t.target).parent()[0]),e=$(t.target).data("pageName"),e="".concat(e),s.context=$(t.target).attr("title").split(" => "),i(t,e)}).delegate("img.remote","click",function(t){var e,n;return $(t.target).attr("src").startsWith("data:image/png")?(t.preventDefault(),n=$(t.target).data("site"),wiki.site(n).refresh(function(){})):(e=$(t.target).data("slug"),s.context=[$(t.target).data("site")],i(t,e))}).appendTo($(".searchbox"))),y=e.search(t),b=t.split(" ").map(function(t){return t.toLowerCase()}).filter(String),m=new RegExp("\\b("+t.split(" ").map(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).filter(String).join("|")+")","i"),u=function(t){return t.split(m).map(function(t){return b.includes(t.toLowerCase())?"{{".concat(t,"}}"):t}).join("")},r=$(".incremental-search").empty(),y.finds&&0!==y.finds.length||$("<div/>").text("No results found").addClass("no-results").appendTo(r),a=0,100,v=[],c=0,d=(p=y.finds).length;c<d;c++)g=p[c],101===(a+=1)&&$("<div/>").text("".concat(y.finds.length-100," results omitted")).addClass("omitted-results").appendTo(r),a>100||(n=$("<div/>").appendTo(r),f={id:l.itemId(),type:"reference",site:g.site,slug:g.page.slug,title:u(g.page.title),text:u(g.page.synopsis)},o(n,f),v.push(n.html(n.html().split(new RegExp("({{.*?}})","i")).map(function(t){return 0===t.indexOf("{{")?"<span class='search-term'>".concat(t.substring(2,t.length-2),"</span>"):t}).join(""))));return v}$(".incremental-search").remove()},performSearch:function(t){var n,r,o,i,c,s,l;if((s=e.search(t)).finds&&1===s.finds.length)return $(".incremental-search").find(".internal").click(),void $(".incremental-search").remove();for($(".incremental-search").remove(),l=s.tally,(c=u()).setTitle("Search for '".concat(t,"'")),c.addParagraph("String '".concat(t,"' found on ").concat(l.finds||"none"," of ").concat(l.pages||"no"," pages from ").concat(l.sites||"no"," sites.\nText matched on ").concat(l.title||"no"," titles, ").concat(l.text||"no"," paragraphs, and ").concat(l.slug||"no"," slugs.\nElapsed time ").concat(l.msec," milliseconds.")),n=0,r=(o=s.finds).length;n<r;n++)i=o[n],c.addItem({type:"reference",site:i.site,slug:i.page.slug,title:i.page.title,text:i.page.synopsis||""});return a.showResult(c)}}},e.exports=r},{"./active":3,"./link":17,"./page":20,"./pageHandler":21,"./random":25,"./resolve":28}],31:[function(t,e,n){"use strict";var r,o,i,a;o=t("./search"),a=null,i=function(t){return a=o({neighborhood:t})},r=function(){return $("input.search").attr("autocomplete","off"),$("input.search").on("keydown",function(t){if(27===t.keyCode)return $(".incremental-search").remove()}),$("input.search").on("keypress",function(t){var e;if(13===t.keyCode)return e=$(this).val(),a.performSearch(e),$(this).val("")}),$("input.search").on("focus",function(t){var e;return e=$(this).val(),a.incrementalSearch(e)}),$("input.search").on("input",function(t){var e;return e=$(this).val(),a.incrementalSearch(e)})},e.exports={inject:i,bind:r}},{"./search":30}],32:[function(t,e,n){"use strict";var r;e.exports={},r=t("./plugin"),e.exports=function(t){return r.getScript("/security/security.js",function(){return window.plugins.security.setup(t)})}},{"./plugin":23}],33:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f,d,h;u=t("async/queue"),a=t("localforage"),e.exports=s={},l={},r={},f={},console.log("siteAdapter: loading data"),(c=a.createInstance({name:"routes"})).iterate(function(t,e,n){l[e]=t}).then(function(){return console.log("siteAdapter: data loaded")}).catch(function(t){return console.log("siteAdapter: error loading data ",t)}),(h=a.createInstance({name:"withCredentials"})).iterate(function(t,e,n){r[e]=t}).then(function(){return console.log("siteAdapter: withCredentials data loaded")}).catch(function(t){return console.log("siteAdapter: error loading withCredentials data ",t)}),d=function(t,e,n){var r,o;return r=new Promise(function(t,e){var n;return n=setTimeout(function(){return clearTimeout(n),e()},3e3)}),o=new Promise(function(e,n){return $.ajax({type:"GET",url:t,success:function(){return e()},error:function(){return n()}})}),Promise.race([r,o]).then(function(){return e()}).catch(function(){return n()})},i=u(function(t,e){var n,r;return n=t.site,null!=l[n]&&e(l[n]),r="//".concat(n,"/favicon.png"),d(r,function(){return l[n]="//".concat(n),e("//".concat(n))},function(){switch(location.protocol){case"http:":return r="https://".concat(n,"/favicon.png"),d(r,function(){return l[n]="https://".concat(n),e("https://".concat(n))},function(){return l[n]="",e("")});case"https:":return r="/proxy/".concat(n,"/favicon.png"),d(r,function(){return l[n]="/proxy/".concat(n),e("/proxy/".concat(n))},function(){return l[n]="",e("")});default:return l[n]="",e("")}})},8),o=function(t,e){return c.getItem(t).then(function(n){return console.log("findAdapter: ",t,n),null==n?i.push({site:t},function(n){return l[t]=n,c.setItem(t,n).then(function(t){return e(n)}).catch(function(r){return console.log("findAdapter setItem error: ",t,r),e(n)})}):(l[t]=n,e(n))}).catch(function(n){return console.log("findAdapter error: ",t,n),l[t]="",e("")})},s.local={flag:function(){return"/favicon.png"},getURL:function(t){return"/".concat(t)},getDirectURL:function(t){return"/".concat(t)},get:function(t,e){var n,r,o,i;if(n=function(t,n){if(e)return e(t,n)},console.log("wiki.local.get ".concat(t)),o=localStorage.getItem(t.replace(/\.json$/,""))){if(n(null,i=JSON.parse(o)),!e)return Promise.resolve(i)}else if(n(r={msg:"no page named '".concat(t,"' in browser local storage")},null),console.log("tried to local fetch a page that isn't local"),!e)return Promise.reject(r)},put:function(t,e,n){return console.log("wiki.local.put ".concat(t)),localStorage.setItem(t,JSON.stringify(e)),n()},delete:function(t){return console.log("wiki.local.delete ".concat(t)),localStorage.removeItem(t)}},s.origin={flag:function(){return"/favicon.png"},getURL:function(t){return"/".concat(t)},getDirectURL:function(t){return"/".concat(t)},get:function(t,e){var n;return n=function(t,n){if(e)return e(t,n)},console.log("wiki.origin.get ".concat(t)),$.ajax({type:"GET",dataType:"json",url:"/".concat(t),success:function(t){return n(null,t)},error:function(t,e,r){return n({msg:r,xhr:t},null)}})},getIndex:function(t,e){var n;return n=function(t,n){if(e)return e(t,n)},console.log("wiki.origin.get ".concat(t)),$.ajax({type:"GET",dataType:"text",url:"/".concat(t),success:function(t){return n(null,t)},error:function(t,e,r){return n({msg:r,xhr:t},null)}})},put:function(t,e,n){return console.log("wiki.orgin.put ".concat(t)),$.ajax({type:"PUT",url:"/page/".concat(t,"/action"),data:{action:JSON.stringify(e)},success:function(){return n(null)},error:function(t,e,r){return n({xhr:t,type:e,msg:r})}})},delete:function(t,e){return console.log("wiki.origin.delete ".concat(t)),$.ajax({type:"DELETE",url:"/".concat(t),success:function(){return e(null)},error:function(t,n,r){return e({xhr:t,type:n,msg:r})}})}},s.recycler={flag:function(){return"/recycler/favicon.png"},getURL:function(t){return"/recycler/".concat(t)},getDirectURL:function(t){return"/recycler/".concat(t)},get:function(t,e){var n;return n=function(t,n){if(e)return e(t,n)},console.log("wiki.recycler.get ".concat(t)),$.ajax({type:"GET",dataType:"json",url:"/recycler/".concat(t),success:function(t){return n(null,t)},error:function(t,e,r){return n({msg:r,xhr:t},null)}})},delete:function(t,e){return console.log("wiki.recycler.delete ".concat(t)),$.ajax({type:"DELETE",url:"/recycler/".concat(t),success:function(){return e(null)},error:function(t,n,r){return e({xhr:t,type:n,msg:r})}})}},s.site=function(t){var e;return t&&t!==window.location.host?"recycler"===t?s.recycler:(e=function(t){var e,n,r,o,i,a,u,c,s,l,f;return console.log("creating temp flag for ".concat(t)),(u=document.createElement("canvas")).width=32,u.height=32,i=u.getContext("2d"),l=c=32*Math.random(),s=32-(f=32*Math.random()),r="#"+(e=(255*Math.random()<<0).toString(16))+e+e,o="#"+(n=(255*Math.random()<<0).toString(16))+n+n,(a=i.createRadialGradient(c,l,32,s,f,0)).addColorStop(0,r),a.addColorStop(1,o),i.fillStyle=a,i.fillRect(0,0,32,32),u.toDataURL()},{flag:function(){var n;return null!=l[t]?""===l[t]?null!=f[t]?f[t]:f[t]=e(t):l[t]+"/favicon.png":null!=f[t]?f[t]:(o(t,function(e){var n,r;return""===e?console.log("Prefix for ".concat(t," is undetermined...")):(console.log("Prefix for ".concat(t," is ").concat(e)),r=f[t],n=l[t]+"/favicon.png",$('img[src="'+r+'"]').attr("src",n),$('a[target="'+t+'"]').attr("style","background-image: url("+n+")"),f[t]=null)}),n=e(t),f[t]=n,n)},getURL:function(e){return null!=l[t]?""===l[t]?(console.log("".concat(t," is unreachable, can't link to ").concat(e)),""):"".concat(l[t],"/").concat(e):(o(t,function(e){return""===e?console.log("".concat(t," is unreachable")):(console.log("Prefix for ".concat(t," is ").concat(e,", about to fixup links")),$('a[target="'+t+'"]').each(function(){var t,n;return/proxy/.test(e)?(n=e.substring(7),t="http://".concat(n)):t=e,$(this).attr("href","".concat(t,"/").concat($(this).data("slug"),".html"))}))}),"")},getDirectURL:function(e){var n,r;return null!=l[t]?""===l[t]?(console.log("".concat(t," is unreachable, can't link to ").concat(e)),""):(/proxy/.test(l[t])?(r=l[t].substring(7),n="http://".concat(r)):n=l[t],"".concat(n,"/").concat(e)):(o(t,function(e){return""===e?console.log("".concat(t," is unreachable")):(console.log("Prefix for ".concat(t," is ").concat(e,", about to fixup links")),$('a[target="'+t+'"]').each(function(){return/proxy/.test(e)?(r=e.substring(7),n="http://".concat(r)):n=e,$(this).attr("href","".concat(n,"/").concat($(this).data("slug"),".html"))}))}),"")},get:function(e,n){var i,a,u;return i=function(t,e){if(n)return n(t,e)},u=function(e,o){var i,a;return i="".concat(l[t],"/").concat(e),a=r[t]||!1,$.ajax({type:"GET",dataType:"json",url:i,xhrFields:{withCredentials:a},success:function(a){return"Login Required"!==a.title||i.includes("login-required")||!0===r[t]?(o(null,a),n?void 0:Promise.resolve(a)):(r[t]=!0,u(e,function(e,n){return e?(r[t]=!1,o(e,n)):(h.setItem(t,!0),o(e,n))}))},error:function(t,e,r){if(o({msg:r,xhr:t},null),!n)return Promise.reject(r)}})},null==l[t]?o(t,function(r){return""!==r?u(e,i):(console.log("".concat(t," is unreachable")),a={msg:"".concat(t," is unreachable"),xhr:{status:0}},i(a,null),n?void 0:Promise.reject(a))}):""!==l[t]?u(e,i):(console.log("".concat(t," is unreachable")),a={msg:"".concat(t," is unreachable"),xhr:{status:0}},i(a,null),n?void 0:Promise.reject(a))},getIndex:function(e,n){var i,a,u;return i=function(t,e){if(n)return n(t,e)},u=function(e,o){var i,a;return i="".concat(l[t],"/").concat(e),a=r[t]||!1,$.ajax({type:"GET",dataType:"text",url:i,xhrFields:{withCredentials:a},success:function(a){return"Login Required"!==a.title||i.includes("login-required")||!0===r[t]?(o(null,a),n?void 0:Promise.resolve(a)):(r[t]=!0,u(e,function(e,n){return e?(r[t]=!1,o(e,n)):(h.setItem(t,!0),o(e,n))}))},error:function(t,e,r){if(o({msg:r,xhr:t},null),!n)return Promise.reject(r)}})},null==l[t]?o(t,function(r){return""!==r?u(e,i):(console.log("".concat(t," is unreachable")),a={msg:"".concat(t," is unreachable"),xhr:{status:0}},i(a,null),n?void 0:Promise.reject(a))}):""!==l[t]?u(e,i):(console.log("".concat(t," is unreachable")),a={msg:"".concat(t," is unreachable"),xhr:{status:0}},i(a,null),n?void 0:Promise.reject(a))},refresh:function(n){var r,o;return console.log("Refreshing ".concat(t)),null==f[t]&&(o=e(t),f[t]=o,r=l[t]+"/favicon.png",$('img[src="'+r+'"]').attr("src",o),$('a[target="'+t+'"]').attr("style","background-image: url("+o+")")),l[t]=null,c.removeItem(t).then(function(){return i.push({site:t},function(e){return c.setItem(t,e).then(function(i){return""===e?console.log("Refreshed prefix for ".concat(t," is undetermined...")):(console.log("Refreshed prefix for ".concat(t," is ").concat(e)),o=f[t],r=l[t]+"/favicon.png",$('img[src="'+o+'"]').attr("src",r),$('a[target="'+t+'"]').attr("style","background-image: url("+r+")")),n()}).catch(function(e){return console.log("findAdapter setItem error: ",t,e),l[t]="",n()})})}).catch(function(e){return console.log("refresh error ",t,e),n()})}}):s.origin}},{"async/queue":47,localforage:49}],34:[function(t,e,n){"use strict";var r,o,i,a,u=[].indexOf;r=t("./active"),o=t("./lineup"),i=null,e.exports=a={},a.inject=function(t){return i=t},a.pagesInDom=function(){return $.makeArray($(".page").map(function(t,e){return e.id}))},a.urlPages=function(){var t;return function(){var e,n,r,o;for(o=[],e=0,n=(r=$(location).attr("pathname").split("/")).length;e<n;e+=2)t=r[e],o.push(t);return o}().slice(1)},a.locsInDom=function(){return $.makeArray($(".page").map(function(t,e){return $(e).data("site")||"view"}))},a.urlLocs=function(){var t,e,n,r,o;for(o=[],e=0,n=(r=$(location).attr("pathname").split("/").slice(1)).length;e<n;e+=2)t=r[e],o.push(t);return o},a.setUrl=function(){var t,e,n,r,i;if(document.title=o.bestTitle(),history&&history.pushState&&(e=a.locsInDom(),r=a.pagesInDom(),(i=function(){var o,i,a;for(a=[],t=o=0,i=r.length;o<i;t=++o)n=r[t],a.push("/".concat((null!=e?e[t]:void 0)||"view","/").concat(n));return a}().join(""))!==$(location).attr("pathname")))return history.pushState(null,null,i)},a.debugStates=function(){var t;return console.log("a .page keys ",function(){var e,n,r,o;for(o=[],e=0,n=(r=$(".page")).length;e<n;e++)t=r[e],o.push($(t).data("key"));return o}()),console.log("a lineup keys",o.debugKeys())},a.show=function(t){var e,n,u,c,s,l,f,d,h,p,g;if(g=a.pagesInDom(),h=a.urlPages(),a.locsInDom(),d=a.urlLocs(),location.pathname&&"/"!==location.pathname){for(l=!0,e=n=0,c=g.length;n<c;e=++n)f=g[e],l&&(l=f===h[e])||(p=$(".page:last"),o.removeKey(p.data("key")),p.remove());for(l=!0,e=u=0,s=h.length;u<s;e=++u)f=h[e],l&&(l=f===g[e])||(console.log("push",e,f),i.showPage(f,d[e]));return a.debugStates(),r.set($(".page").last()),document.title=o.bestTitle()}},a.first=function(){var t,e,n,r,o,c,s,l;for(a.setUrl(),e=a.urlPages(),t=a.urlLocs(),c=a.pagesInDom(),s=[],n=r=0,o=e.length;r<o;n=++r)l=e[n],u.call(c,l)<0&&(""!==l?s.push(i.createPage(l,t[n])):s.push(void 0));return s}},{"./active":3,"./lineup":16}],35:[function(t,e,n){"use strict";e.exports=function(t){var e,n,r;return r=t.synopsis,null!=t&&null!=t.story?(e=t.story[0],n=t.story[1],e&&"paragraph"===e.type&&(r||(r=e.text)),n&&"paragraph"===n.type&&(r||(r=n.text)),e&&null!=e.text&&(r||(r=e.text)),n&&null!=n.text&&(r||(r=n.text)),r||(r=null!=t.story&&"A page with ".concat(t.story.length," items."))):r="A page with no story.",(r=r.trim().split(/\r|\n/,1)[0]).substring(0,560)}},{}],36:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i,a,u,c,s,l,f,d,h,p,g,v,m,y,b,w,x;x=!1,d=null,h=null,i=null,c=null,u=function(){return $(document).keydown(function(t){if(16===t.keyCode)return b(t)}).keyup(function(t){if(16===t.keyCode)return w(t)}),$(".main").delegate(".item","mouseenter",f).delegate(".item","mouseleave",m).delegate(".action","mouseenter",s).delegate(".action","mouseleave",g).delegate(".page","align-item",a).delegate(".backlinks .remote","mouseenter",l).delegate(".backlinks .remote","mouseleave",v)},b=function(t){var e;if((x=t.shiftKey)&&($(".emit").addClass("highlight"),(e=d||i)&&$("[data-id=".concat(e,"]")).addClass("target"),h&&(c=h.consuming)))return c.forEach(function(t){return p(t).addClass("consumed")})},w=function(t){if(!(x=t.shiftKey))return $(".emit").removeClass("highlight"),$(".item, .action").removeClass("target"),$(".item").removeClass("consumed")},y=function(t){var e;return 0===(e=$(".page").filter(function(e,n){return $(n).data("key")===t})).length?null:(e.length>1&&console.log("warning: more than one page found for",key,e),e)},p=function(t){var e,n,o,i,a=r(t.split("/"),2);return i=a[0],o=a[1],(n=y(i))?0===(e=n.find(".item[data-id=".concat(o,"]"))).length?null:(e.length>1&&console.log("warning: more than one item found for",t,e),e):null},f=function(t){var e,n,r;if(d=(e=$(this)).attr("data-id"),h=e[0],x&&($("[data-id=".concat(d,"]")).addClass("target"),n=$(this).parents(".page:first").data("key"),r=e.offset().top,$(".page").trigger("align-item",{key:n,id:d,place:r}),c=h.consuming))return c.forEach(function(t){return p(t).addClass("consumed")})},m=function(t){return x&&($(".item, .action").removeClass("target"),$(".item").removeClass("consumed")),d=null,h=null},s=function(t){var e;if(i=$(this).data("id"),x)return $("[data-id=".concat(i,"]")).addClass("target"),e=$(this).parents(".page:first").data("key"),$(".page").trigger("align-item",{key:e,id:i})},g=function(t){return x&&$("[data-id=".concat(i,"]")).removeClass("target"),i=null},l=function(t){var e,n,r;if(d=(e=$(this)).attr("data-id"),h=e[0],x)return $("[data-id=".concat(d,"]")).addClass("target"),n=$(this).parents(".page:first").data("key"),r=e.offset().top,$(".page").trigger("align-item",{key:n,id:d,place:r})},v=function(t){return x&&$(".item, .action").removeClass("target"),d=null,h=null},a=function(t,e){var n,r,o,i;if((r=$(this)).data("key")!==e.key&&(n=r.find(".item[data-id=".concat(e.id,"]"))).length)return i=e.place||r.height()/2,o=n.offset().top+r.scrollTop()-i,r.stop().animate({scrollTop:o},"slow")},e.exports={bind:u}},{}],37:[function(t,e,n){"use strict";var r;e.exports=r={},r.formatTime=function(t){var e,n,r,o,i;return i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][(n=new Date(t>1e10?t:1e3*t)).getMonth()],e=(r=n.getHours())<12?"AM":"PM",r=0===r?12:r>12?r-12:r,o=(n.getMinutes()<10?"0":"")+n.getMinutes(),"".concat(r,":").concat(o," ").concat(e,"<br>").concat(n.getDate()," ").concat(i," ").concat(n.getFullYear())},r.formatDate=function(t){var e,n,r,o,i,a,u,c,s;return c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][(n=new Date(t)).getDay()],a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()],r=n.getDate(),s=n.getFullYear(),e=(o=n.getHours())<12?"AM":"PM",o=0===o?12:o>12?o-12:o,i=(n.getMinutes()<10?"0":"")+n.getMinutes(),u=(n.getSeconds()<10?"0":"")+n.getSeconds(),"".concat(c," ").concat(a," ").concat(r,", ").concat(s,"<br>").concat(o,":").concat(i,":").concat(u," ").concat(e)},r.formatElapsedTime=function(t){var e,n,r,o,i,a,u,c;return(a=(i=(new Date).getTime()-t)/1e3)<2?"".concat(Math.floor(i)," milliseconds ago"):(r=a/60)<2?"".concat(Math.floor(a)," seconds ago"):(n=r/60)<2?"".concat(Math.floor(r)," minutes ago"):(e=n/24)<2?"".concat(Math.floor(n)," hours ago"):(u=e/7)<2?"".concat(Math.floor(e)," days ago"):(o=e/31)<2?"".concat(Math.floor(u)," weeks ago"):(c=e/365)<2?"".concat(Math.floor(o)," months ago"):"".concat(Math.floor(c)," years ago")}},{}],38:[function(t,e,n){"use strict";var r,o,i,a,u,c,s,l,f,d;d={},f=t("./siteAdapter"),d.local=f.local,d.origin=f.origin,d.recycler=f.recycler,d.site=f.site,d.asSlug=t("./page").asSlug,d.newPage=t("./page").newPage,i=t("./itemz"),d.removeItem=i.removeItem,d.createItem=i.createItem,d.getItem=i.getItem,r=t("./dialog"),d.dialog=r.open,a=t("./link"),d.createPage=a.createPage,d.doInternalLink=a.doInternalLink,d.showResult=a.showResult,s=t("./plugin"),d.getScript=s.getScript,d.getPlugin=s.getPlugin,d.doPlugin=s.doPlugin,d.registerPlugin=s.registerPlugin,d.getData=function(t){var e,n;return t?(e=$(".item").index(t),null!=(n=$(".item:lt(".concat(e,")")).filter(".chart,.data,.calculator").last())?n.data("item").data:{}):null!=(n=$(".chart,.data,.calculator").last())?n.data("item").data:{}},d.getDataNodes=function(t){var e,n;return t?(e=$(".item").index(t),n=$(".item:lt(".concat(e,")")).filter(".chart,.data,.calculator").toArray().reverse(),$(n)):(n=$(".chart,.data,.calculator").toArray().reverse(),$(n))},d.log=function(){var t;if(null!=("undefined"!=typeof console&&null!==console?console.log:void 0))return(t=console).log.apply(t,arguments)},u=t("./neighborhood"),d.neighborhood=u.sites,d.neighborhoodObject=u,c=t("./pageHandler"),d.pageHandler=c,d.useLocalStorage=c.useLocalStorage,l=t("./resolve"),d.resolveFrom=l.resolveFrom,d.resolveLinks=l.resolveLinks,d.resolutionContext=l.resolutionContext,o=t("./editor"),d.textEditor=o.textEditor,d.util=t("./util"),d.security=t("./security"),d.createSynopsis=t("./synopsis"),d.lineup=t("./lineup"),e.exports=d},{"./dialog":6,"./editor":8,"./itemz":13,"./lineup":16,"./link":17,"./neighborhood":18,"./page":20,"./pageHandler":21,"./plugin":23,"./resolve":28,"./security":32,"./siteAdapter":33,"./synopsis":35,"./util":37}],39:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return(0,o.default)(function(e,n){var o;try{o=t.apply(this,e)}catch(t){return n(t)}(0,r.default)(o)&&"function"==typeof o.then?o.then(function(t){u(n,null,t)},function(t){u(n,t.message?t:new Error(t))}):n(null,o)})};var r=a(t("lodash/isObject")),o=a(t("./internal/initialParams")),i=a(t("./internal/setImmediate"));function a(t){return t&&t.__esModule?t:{default:t}}function u(t,e,n){try{t(e,n)}catch(t){(0,i.default)(c,t)}}function c(t){throw t}e.exports=n.default},{"./internal/initialParams":41,"./internal/setImmediate":44,"lodash/isObject":55}],40:[function(t,e,n){"use strict";function r(){this.head=this.tail=null,this.length=0}function o(t,e){t.length=1,t.head=t.tail=e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r,r.prototype.removeLink=function(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,this.length-=1,t},r.prototype.empty=function(){for(;this.head;)this.shift();return this},r.prototype.insertAfter=function(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1},r.prototype.insertBefore=function(t,e){e.prev=t.prev,e.next=t,t.prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1},r.prototype.unshift=function(t){this.head?this.insertBefore(this.head,t):o(this,t)},r.prototype.push=function(t){this.tail?this.insertAfter(this.tail,t):o(this,t)},r.prototype.shift=function(){return this.head&&this.removeLink(this.head)},r.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},r.prototype.toArray=function(){for(var t=Array(this.length),e=this.head,n=0;n<this.length;n++)t[n]=e.data,e=e.next;return t},r.prototype.remove=function(t){for(var e=this.head;e;){var n=e.next;t(e)&&this.removeLink(e),e=n}return this},e.exports=n.default},{}],41:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return function(){var e=(0,i.default)(arguments),n=e.pop();t.call(this,e,n)}};var r,o=t("./slice"),i=(r=o)&&r.__esModule?r:{default:r};e.exports=n.default},{"./slice":45}],42:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}},e.exports=n.default},{}],43:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,n){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var l=(0,s.default)(t),f=0,d=[],h=!1;function p(t,e,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(m.started=!0,(0,o.default)(t)||(t=[t]),0===t.length&&m.idle())return(0,u.default)(function(){m.drain()});for(var r=0,a=t.length;r<a;r++){var c={data:t[r],callback:n||i.default};e?m._tasks.unshift(c):m._tasks.push(c)}h||(h=!0,(0,u.default)(function(){h=!1,m.process()}))}function g(t){return function(e){f-=1;for(var n=0,o=t.length;n<o;n++){var i=t[n],a=(0,r.default)(d,i,0);0===a?d.shift():a>0&&d.splice(a,1),i.callback.apply(i,arguments),null!=e&&m.error(e,i.data)}f<=m.concurrency-m.buffer&&m.unsaturated(),m.idle()&&m.drain(),m.process()}}var v=!1,m={_tasks:new c.default,concurrency:e,payload:n,saturated:i.default,unsaturated:i.default,buffer:e/4,empty:i.default,drain:i.default,error:i.default,started:!1,paused:!1,push:function(t,e){p(t,!1,e)},kill:function(){m.drain=i.default,m._tasks.empty()},unshift:function(t,e){p(t,!0,e)},remove:function(t){m._tasks.remove(t)},process:function(){if(!v){for(v=!0;!m.paused&&f<m.concurrency&&m._tasks.length;){var t=[],e=[],n=m._tasks.length;m.payload&&(n=Math.min(n,m.payload));for(var r=0;r<n;r++){var o=m._tasks.shift();t.push(o),d.push(o),e.push(o.data)}f+=1,0===m._tasks.length&&m.empty(),f===m.concurrency&&m.saturated();var i=(0,a.default)(g(t));l(e,i)}v=!1}},length:function(){return m._tasks.length},running:function(){return f},workersList:function(){return d},idle:function(){return m._tasks.length+f===0},pause:function(){m.paused=!0},resume:function(){!1!==m.paused&&(m.paused=!1,(0,u.default)(m.process))}};return m};var r=l(t("lodash/_baseIndexOf")),o=l(t("lodash/isArray")),i=l(t("lodash/noop")),a=l(t("./onlyOnce")),u=l(t("./setImmediate")),c=l(t("./DoublyLinkedList")),s=l(t("./wrapAsync"));function l(t){return t&&t.__esModule?t:{default:t}}e.exports=n.default},{"./DoublyLinkedList":40,"./onlyOnce":42,"./setImmediate":44,"./wrapAsync":46,"lodash/_baseIndexOf":51,"lodash/isArray":54,"lodash/noop":56}],44:[function(t,e,n){(function(e,r){(function(){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.hasNextTick=n.hasSetImmediate=void 0,n.fallback=l,n.wrap=f;var o,i=t("./slice"),a=(o=i)&&o.__esModule?o:{default:o};var u,c=n.hasSetImmediate="function"==typeof r&&r,s=n.hasNextTick="object"==typeof e&&"function"==typeof e.nextTick;function l(t){setTimeout(t,0)}function f(t){return function(e){var n=(0,a.default)(arguments,1);t(function(){e.apply(null,n)})}}u=c?r:s?e.nextTick:l,n.default=f(u)}).call(this)}).call(this,t("_process"),t("timers").setImmediate)},{"./slice":45,_process:58,timers:63}],45:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e){e|=0;for(var n=Math.max(t.length-e,0),r=Array(n),o=0;o<n;o++)r[o]=t[e+o];return r},e.exports=n.default},{}],46:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isAsync=void 0;var r,o=t("../asyncify"),i=(r=o)&&r.__esModule?r:{default:r};var a="function"==typeof Symbol;function u(t){return a&&"AsyncFunction"===t[Symbol.toStringTag]}n.default=function(t){return u(t)?(0,i.default)(t):t},n.isAsync=u},{"../asyncify":39}],47:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e){var n=(0,o.default)(t);return(0,r.default)(function(t,e){n(t[0],e)},e,1)};var r=i(t("./internal/queue")),o=i(t("./internal/wrapAsync"));function i(t){return t&&t.__esModule?t:{default:t}}e.exports=n.default},{"./internal/queue":43,"./internal/wrapAsync":46}],48:[function(t,e,n){var r=Object.create||function(t){var e=function(){};return e.prototype=t,new e},o=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return n},i=Function.prototype.bind||function(t){var e=this;return function(){return e.apply(t,arguments)}};function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=r(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var u,c=10;try{var s={};Object.defineProperty&&Object.defineProperty(s,"x",{value:0}),u=0===s.x}catch(t){u=!1}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function f(t,e,n,o){var i,a,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((a=t._events)?(a.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),u=a[e]):(a=t._events=r(null),t._eventsCount=0),u){if("function"==typeof u?u=a[e]=o?[n,u]:[u,n]:o?u.unshift(n):u.push(n),!u.warned&&(i=l(t))&&i>0&&u.length>i){u.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+u.length+' "'+String(e)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=u.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",c.name,c.message)}}else u=a[e]=n,++t._eventsCount;return t}function d(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];this.listener.apply(this.target,t)}}function h(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=i.call(d,r);return o.listener=n,r.wrapFn=o,o}function p(t,e,n){var r=t._events;if(!r)return[];var o=r[e];return o?"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):v(o,o.length):[]}function g(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function v(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}u?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||t!=t)throw new TypeError('"defaultMaxListeners" must be a positive number');c=t}}):a.defaultMaxListeners=c,a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){var e,n,r,o,i,a,u="error"===t;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(u){if(arguments.length>1&&(e=arguments[1]),e instanceof Error)throw e;var c=new Error('Unhandled "error" event. ('+e+")");throw c.context=e,c}if(!(n=a[t]))return!1;var s="function"==typeof n;switch(r=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var r=t.length,o=v(t,r),i=0;i<r;++i)o[i].call(n)}(n,s,this);break;case 2:!function(t,e,n,r){if(e)t.call(n,r);else for(var o=t.length,i=v(t,o),a=0;a<o;++a)i[a].call(n,r)}(n,s,this,arguments[1]);break;case 3:!function(t,e,n,r,o){if(e)t.call(n,r,o);else for(var i=t.length,a=v(t,i),u=0;u<i;++u)a[u].call(n,r,o)}(n,s,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,r,o,i){if(e)t.call(n,r,o,i);else for(var a=t.length,u=v(t,a),c=0;c<a;++c)u[c].call(n,r,o,i)}(n,s,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(r-1),i=1;i<r;i++)o[i-1]=arguments[i];!function(t,e,n,r){if(e)t.apply(n,r);else for(var o=t.length,i=v(t,o),a=0;a<o;++a)i[a].apply(n,r)}(n,s,this,o)}return!0},a.prototype.addListener=function(t,e){return f(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return f(this,t,e,!0)},a.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,h(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,h(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,o,i,a,u;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(o=this._events))return this;if(!(n=o[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=r(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){u=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(t,e){for(var n=e,r=n+1,o=t.length;r<o;n+=1,r+=1)t[n]=t[r];t.pop()}(n,i),1===n.length&&(o[t]=n[0]),o.removeListener&&this.emit("removeListener",t,u||e)}return this},a.prototype.removeAllListeners=function(t){var e,n,i;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=r(null),this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=r(null):delete n[t]),this;if(0===arguments.length){var a,u=o(n);for(i=0;i<u.length;++i)"removeListener"!==(a=u[i])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=r(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},a.prototype.listeners=function(t){return p(this,t,!0)},a.prototype.rawListeners=function(t){return p(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},a.prototype.listenerCount=g,a.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],49:[function(t,e,n){(function(r){(function(){!function(t){if("object"==typeof n&&void 0!==e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this).localforage=t()}}(function(){return function e(n,r,o){function i(u,c){if(!r[u]){if(!n[u]){var s="function"==typeof t&&t;if(!c&&s)return s(u,!0);if(a)return a(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[u]={exports:{}};n[u][0].call(f.exports,function(t){var e=n[u][1][t];return i(e||t)},f,f.exports,e,n,r,o)}return r[u].exports}for(var a="function"==typeof t&&t,u=0;u<o.length;u++)i(o[u]);return i}({1:[function(t,e,n){(function(t){"use strict";var n,r,o=t.MutationObserver||t.WebKitMutationObserver;if(o){var i=0,a=new o(l),u=t.document.createTextNode("");a.observe(u,{characterData:!0}),n=function(){u.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var c=new t.MessageChannel;c.port1.onmessage=l,n=function(){c.port2.postMessage(0)}}var s=[];function l(){var t,e;r=!0;for(var n=s.length;n;){for(e=s,s=[],t=-1;++t<n;)e[t]();n=s.length}r=!1}e.exports=function(t){1!==s.push(t)||r||n()}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var r=t(1);function o(){}var i={},a=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function s(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,t!==o&&h(this,t)}function l(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(t,e,n){r(function(){var r;try{r=e(n)}catch(e){return i.reject(t,e)}r===t?i.reject(t,new TypeError("Cannot resolve promise with itself")):i.resolve(t,r)})}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function h(t,e){var n=!1;function r(e){n||(n=!0,i.reject(t,e))}function o(e){n||(n=!0,i.resolve(t,e))}var a=p(function(){e(o,r)});"error"===a.status&&r(a.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}e.exports=s,s.prototype.catch=function(t){return this.then(null,t)},s.prototype.then=function(t,e){if("function"!=typeof t&&this.state===u||"function"!=typeof e&&this.state===a)return this;var n=new this.constructor(o);this.state!==c?f(n,this.state===u?t:e,this.outcome):this.queue.push(new l(n,t,e));return n},l.prototype.callFulfilled=function(t){i.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){f(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){i.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){f(this.promise,this.onRejected,t)},i.resolve=function(t,e){var n=p(d,e);if("error"===n.status)return i.reject(t,n.value);var r=n.value;if(r)h(t,r);else{t.state=u,t.outcome=e;for(var o=-1,a=t.queue.length;++o<a;)t.queue[o].callFulfilled(e)}return t},i.reject=function(t,e){t.state=a,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},s.resolve=function(t){if(t instanceof this)return t;return i.resolve(new this(o),t)},s.reject=function(t){var e=new this(o);return i.reject(e,t)},s.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var a=new Array(n),u=0,c=-1,s=new this(o);for(;++c<n;)l(t[c],c);return s;function l(t,o){e.resolve(t).then(function(t){a[o]=t,++u!==n||r||(r=!0,i.resolve(s,a))},function(t){r||(r=!0,i.reject(s,t))})}},s.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var a=-1,u=new this(o);for(;++a<n;)c=t[a],e.resolve(c).then(function(t){r||(r=!0,i.resolve(u,t))},function(t){r||(r=!0,i.reject(u,t))});var c;return u}},{1:1}],3:[function(t,e,n){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function i(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var a=Promise;function u(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function c(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function s(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function l(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var f="local-forage-detect-blob-support",d=void 0,h={},p=Object.prototype.toString,g="readonly",v="readwrite";function m(t){return"boolean"==typeof d?a.resolve(d):function(t){return new a(function(e){var n=t.transaction(f,v),r=i([""]);n.objectStore(f).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}(t).then(function(t){return d=t})}function y(t){var e=h[t.name],n={};n.promise=new a(function(t,e){n.resolve=t,n.reject=e}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function b(t){var e=h[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function w(t,e){var n=h[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function x(t,e){return new a(function(n,r){if(h[t.name]=h[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return n(t.db);y(t),t.db.close()}var i=[t.name];e&&i.push(t.version);var a=o.open.apply(o,i);e&&(a.onupgradeneeded=function(e){var n=a.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(f)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),a.onerror=function(t){t.preventDefault(),r(a.error)},a.onsuccess=function(){n(a.result),b(t)}})}function k(t){return x(t,!1)}function _(t){return x(t,!0)}function I(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,o=t.version>t.db.version;if(r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),o||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function j(t){return i([function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;o<e;o++)r[o]=t.charCodeAt(o);return n}(atob(t.data))],{type:t.type})}function S(t){return t&&t.__local_forage_encoded_blob}function A(t){var e=this,n=e._initReady().then(function(){var t=h[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return c(n,t,t),n}function E(t,e,n,r){void 0===r&&(r=1);try{var o=t.db.transaction(t.storeName,e);n(null,o)}catch(o){if(r>0&&(!t.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return a.resolve().then(function(){if(!t.db||"NotFoundError"===o.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),_(t)}).then(function(){return function(t){y(t);for(var e=h[t.name],n=e.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return t.db=null,k(t).then(function(e){return t.db=e,I(t)?_(t):e}).then(function(r){t.db=e.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r}).catch(function(e){throw w(t,e),e})}(t).then(function(){E(t,e,n,r-1)})}).catch(n);n(o)}}var $={_driver:"asyncStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]=t[r];var o=h[n.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},h[n.name]=o),o.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=A);var i=[];function u(){return a.resolve()}for(var c=0;c<o.forages.length;c++){var s=o.forages[c];s!==e&&i.push(s._initReady().catch(u))}var l=o.forages.slice(0);return a.all(i).then(function(){return n.db=o.db,k(n)}).then(function(t){return n.db=t,I(n,e._defaultConfig.version)?_(n):t}).then(function(t){n.db=o.db=t,e._dbInfo=n;for(var r=0;r<l.length;r++){var i=l[r];i!==e&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}})},_support:function(){try{if(!o||!o.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,e){var n=this,r=new a(function(e,r){n.ready().then(function(){E(n._dbInfo,g,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName).openCursor(),u=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;S(r)&&(r=j(r));var o=t(r,n.key,u++);void 0!==o?e(o):n.continue()}else e()},a.onerror=function(){r(a.error)}}catch(t){r(t)}})}).catch(r)});return u(r,e),r},getItem:function(t,e){var n=this;t=s(t);var r=new a(function(e,r){n.ready().then(function(){E(n._dbInfo,g,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName).get(t);a.onsuccess=function(){var t=a.result;void 0===t&&(t=null),S(t)&&(t=j(t)),e(t)},a.onerror=function(){r(a.error)}}catch(t){r(t)}})}).catch(r)});return u(r,e),r},setItem:function(t,e,n){var r=this;t=s(t);var o=new a(function(n,o){var i;r.ready().then(function(){return i=r._dbInfo,"[object Blob]"===p.call(e)?m(i.db).then(function(t){return t?e:(n=e,new a(function(t,e){var r=new FileReader;r.onerror=e,r.onloadend=function(e){var r=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:n.type})},r.readAsBinaryString(n)}));var n}):e}).then(function(e){E(r._dbInfo,v,function(i,a){if(i)return o(i);try{var u=a.objectStore(r._dbInfo.storeName);null===e&&(e=void 0);var c=u.put(e,t);a.oncomplete=function(){void 0===e&&(e=null),n(e)},a.onabort=a.onerror=function(){var t=c.error?c.error:c.transaction.error;o(t)}}catch(t){o(t)}})}).catch(o)});return u(o,n),o},removeItem:function(t,e){var n=this;t=s(t);var r=new a(function(e,r){n.ready().then(function(){E(n._dbInfo,v,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName).delete(t);i.oncomplete=function(){e()},i.onerror=function(){r(a.error)},i.onabort=function(){var t=a.error?a.error:a.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return u(r,e),r},clear:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){E(e._dbInfo,v,function(r,o){if(r)return n(r);try{var i=o.objectStore(e._dbInfo.storeName).clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var t=i.error?i.error:i.transaction.error;n(t)}}catch(t){n(t)}})}).catch(n)});return u(n,t),n},length:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){E(e._dbInfo,g,function(r,o){if(r)return n(r);try{var i=o.objectStore(e._dbInfo.storeName).count();i.onsuccess=function(){t(i.result)},i.onerror=function(){n(i.error)}}catch(t){n(t)}})}).catch(n)});return u(n,t),n},key:function(t,e){var n=this,r=new a(function(e,r){t<0?e(null):n.ready().then(function(){E(n._dbInfo,g,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),u=!1,c=a.openKeyCursor();c.onsuccess=function(){var n=c.result;n?0===t?e(n.key):u?e(n.key):(u=!0,n.advance(t)):e(null)},c.onerror=function(){r(c.error)}}catch(t){r(t)}})}).catch(r)});return u(r,e),r},keys:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){E(e._dbInfo,g,function(r,o){if(r)return n(r);try{var i=o.objectStore(e._dbInfo.storeName).openKeyCursor(),a=[];i.onsuccess=function(){var e=i.result;e?(a.push(e.key),e.continue()):t(a)},i.onerror=function(){n(i.error)}}catch(t){n(t)}})}).catch(n)});return u(n,t),n},dropInstance:function(t,e){e=l.apply(this,arguments);var n,r=this.config();if((t="function"!=typeof t&&t||{}).name||(t.name=t.name||r.name,t.storeName=t.storeName||r.storeName),t.name){var i=t.name===r.name&&this._dbInfo.db?a.resolve(this._dbInfo.db):k(t).then(function(e){var n=h[t.name],r=n.forages;n.db=e;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=e;return e});n=t.storeName?i.then(function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;y(t);var r=h[t.name],i=r.forages;e.close();for(var u=0;u<i.length;u++){var c=i[u];c._dbInfo.db=null,c._dbInfo.version=n}return new a(function(e,r){var i=o.open(t.name,n);i.onerror=function(t){i.result.close(),r(t)},i.onupgradeneeded=function(){i.result.deleteObjectStore(t.storeName)},i.onsuccess=function(){var t=i.result;t.close(),e(t)}}).then(function(t){r.db=t;for(var e=0;e<i.length;e++){var n=i[e];n._dbInfo.db=t,b(n._dbInfo)}}).catch(function(e){throw(w(t,e)||a.resolve()).catch(function(){}),e})}}):i.then(function(e){y(t);var n=h[t.name],r=n.forages;e.close();for(var i=0;i<r.length;i++)r[i]._dbInfo.db=null;return new a(function(e,n){var r=o.deleteDatabase(t.name);r.onerror=r.onblocked=function(t){var e=r.result;e&&e.close(),n(t)},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}}).then(function(t){n.db=t;for(var e=0;e<r.length;e++)b(r[e]._dbInfo)}).catch(function(e){throw(w(t,e)||a.resolve()).catch(function(){}),e})})}else n=a.reject("Invalid arguments");return u(n,e),n}};var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O="~~local_forage_type~",T=/^~~local_forage_type~([^~]+)~/,F="__lfsc__:",L=F.length,P="arbf",D="blob",R="si08",N="ui08",M="uic8",B="si16",z="si32",U="ur16",q="ui32",K="fl32",W="fl64",H=L+P.length,J=Object.prototype.toString;function G(t){var e,n,r,o,i,a=.75*t.length,u=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var s=new ArrayBuffer(a),l=new Uint8Array(s);for(e=0;e<u;e+=4)n=C.indexOf(t[e]),r=C.indexOf(t[e+1]),o=C.indexOf(t[e+2]),i=C.indexOf(t[e+3]),l[c++]=n<<2|r>>4,l[c++]=(15&r)<<4|o>>2,l[c++]=(3&o)<<6|63&i;return s}function V(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=C[n[e]>>2],r+=C[(3&n[e])<<4|n[e+1]>>4],r+=C[(15&n[e+1])<<2|n[e+2]>>6],r+=C[63&n[e+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var Y={serialize:function(t,e){var n="";if(t&&(n=J.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===J.call(t.buffer))){var r,o=F;t instanceof ArrayBuffer?(r=t,o+=P):(r=t.buffer,"[object Int8Array]"===n?o+=R:"[object Uint8Array]"===n?o+=N:"[object Uint8ClampedArray]"===n?o+=M:"[object Int16Array]"===n?o+=B:"[object Uint16Array]"===n?o+=U:"[object Int32Array]"===n?o+=z:"[object Uint32Array]"===n?o+=q:"[object Float32Array]"===n?o+=K:"[object Float64Array]"===n?o+=W:e(new Error("Failed to get type for BinaryArray"))),e(o+V(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=O+t.type+"~"+V(this.result);e(F+D+n)},i.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if(t.substring(0,L)!==F)return JSON.parse(t);var e,n=t.substring(H),r=t.substring(L,H);if(r===D&&T.test(n)){var o=n.match(T);e=o[1],n=n.substring(o[0].length)}var a=G(n);switch(r){case P:return a;case D:return i([a],{type:e});case R:return new Int8Array(a);case N:return new Uint8Array(a);case M:return new Uint8ClampedArray(a);case B:return new Int16Array(a);case U:return new Uint16Array(a);case z:return new Int32Array(a);case q:return new Uint32Array(a);case K:return new Float32Array(a);case W:return new Float64Array(a);default:throw new Error("Unkown type: "+r)}},stringToBuffer:G,bufferToString:V};function Q(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function X(t,e,n,r,o,i){t.executeSql(n,r,o,function(t,a){a.code===a.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,u){u.rows.length?i(t,a):Q(t,e,function(){t.executeSql(n,r,o,i)},i)},i):i(t,a)},i)}var Z={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var o=new a(function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return r(t)}n.db.transaction(function(o){Q(o,n,function(){e._dbInfo=n,t()},function(t,e){r(e)})},r)});return n.serializer=Y,o},_support:"function"==typeof openDatabase,iterate:function(t,e){var n=this,r=new a(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){X(n,o,"SELECT * FROM "+o.storeName,[],function(n,r){for(var i=r.rows,a=i.length,u=0;u<a;u++){var c=i.item(u),s=c.value;if(s&&(s=o.serializer.deserialize(s)),void 0!==(s=t(s,c.key,u+1)))return void e(s)}e()},function(t,e){r(e)})})}).catch(r)});return u(r,e),r},getItem:function(t,e){var n=this;t=s(t);var r=new a(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){X(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),e(r)},function(t,e){r(e)})})}).catch(r)});return u(r,e),r},setItem:function(t,e,n){return function t(e,n,r,o){var i=this;e=s(e);var c=new a(function(a,u){i.ready().then(function(){void 0===n&&(n=null);var c=n,s=i._dbInfo;s.serializer.serialize(n,function(n,l){l?u(l):s.db.transaction(function(t){X(t,s,"INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,n],function(){a(c)},function(t,e){u(e)})},function(n){if(n.code===n.QUOTA_ERR){if(o>0)return void a(t.apply(i,[e,c,r,o-1]));u(n)}})})}).catch(u)});return u(c,r),c}.apply(this,[t,e,n,1])},removeItem:function(t,e){var n=this;t=s(t);var r=new a(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){X(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){r(e)})})}).catch(r)});return u(r,e),r},clear:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){X(e,r,"DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return u(n,t),n},length:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){X(e,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})}).catch(n)});return u(n,t),n},key:function(t,e){var n=this,r=new a(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){X(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})}).catch(r)});return u(r,e),r},keys:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){X(e,r,"SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);t(r)},function(t,e){n(e)})})}).catch(n)});return u(n,t),n},dropInstance:function(t,e){e=l.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,o=this;return u(r=t.name?new a(function(e){var r;r=t.name===n.name?o._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:r,storeNames:[t.storeName]}):e(function(t){return new a(function(e,n){t.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,r){for(var o=[],i=0;i<r.rows.length;i++)o.push(r.rows.item(i).name);e({db:t,storeNames:o})},function(t,e){n(e)})},function(t){n(t)})})}(r))}).then(function(t){return new a(function(e,n){t.db.transaction(function(r){function o(t){return new a(function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){n(e)})})}for(var i=[],u=0,c=t.storeNames.length;u<c;u++)i.push(o(t.storeNames[u]));a.all(i).then(function(){e()}).catch(function(t){n(t)})},function(t){n(t)})})}):a.reject("Invalid arguments"),e),r}};function tt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function et(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(t){return!0}}()||localStorage.length>0}var nt={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=tt(t,this._defaultConfig),et()?(this._dbInfo=e,e.serializer=Y,a.resolve()):a.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,r=e.keyPrefix,o=r.length,i=localStorage.length,a=1,u=0;u<i;u++){var c=localStorage.key(u);if(0===c.indexOf(r)){var s=localStorage.getItem(c);if(s&&(s=e.serializer.deserialize(s)),void 0!==(s=t(s,c.substring(o),a++)))return s}}});return u(r,e),r},getItem:function(t,e){var n=this;t=s(t);var r=n.ready().then(function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r});return u(r,e),r},setItem:function(t,e,n){var r=this;t=s(t);var o=r.ready().then(function(){void 0===e&&(e=null);var n=e;return new a(function(o,i){var a=r._dbInfo;a.serializer.serialize(e,function(e,r){if(r)i(r);else try{localStorage.setItem(a.keyPrefix+t,e),o(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||i(t),i(t)}})})});return u(o,n),o},removeItem:function(t,e){var n=this;t=s(t);var r=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return u(r,e),r},clear:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}});return u(n,t),n},length:function(t){var e=this.keys().then(function(t){return t.length});return u(e,t),e},key:function(t,e){var n=this,r=n.ready().then(function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e});return u(r,e),r},keys:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var i=localStorage.key(o);0===i.indexOf(t.keyPrefix)&&r.push(i.substring(t.keyPrefix.length))}return r});return u(n,t),n},dropInstance:function(t,e){if(e=l.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var r,o=this;return u(r=t.name?new a(function(e){t.storeName?e(tt(t,o._defaultConfig)):e(t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):a.reject("Invalid arguments"),e),r}},rt=function(t,e){for(var n,r,o=t.length,i=0;i<o;){if((n=t[i])===(r=e)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;i++}return!1},ot=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},it={},at={},ut={INDEXEDDB:$,WEBSQL:Z,LOCALSTORAGE:nt},ct=[ut.INDEXEDDB._driver,ut.WEBSQL._driver,ut.LOCALSTORAGE._driver],st=["dropInstance"],lt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(st),ft={description:"",driver:ct.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function dt(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function ht(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(ot(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var pt=new(function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ut)if(ut.hasOwnProperty(n)){var r=ut[n],o=r._driver;this[n]=o,it[o]||this.defineDriver(r)}this._defaultConfig=ht({},ft),this._config=ht({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":r(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new a(function(e,n){try{var r=t._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(o);for(var i=lt.concat("_initStorage"),c=0,s=i.length;c<s;c++){var l=i[c];if((!rt(st,l)||t[l])&&"function"!=typeof t[l])return void n(o)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=a.reject(e);return u(n,arguments[arguments.length-1]),n}},n=0,r=st.length;n<r;n++){var o=st[n];t[o]||(t[o]=e(o))}}();var f=function(n){it[r]&&console.info("Redefining LocalForage driver: "+r),it[r]=t,at[r]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(f,n):f(!!t._support):f(!0)}catch(t){n(t)}});return c(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=it[t]?a.resolve(it[t]):a.reject(new Error("Driver not found."));return c(r,e,n),r},t.prototype.getSerializer=function(t){var e=a.resolve(Y);return c(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return c(n,t,t),n},t.prototype.setDriver=function(t,e,n){var r=this;ot(t)||(t=[t]);var o=this._getSupportedDrivers(t);function i(){r._config.driver=r.driver()}function u(t){return r._extend(t),i(),r._ready=r._initStorage(r._config),r._ready}var s=null!==this._driverSet?this._driverSet.catch(function(){return a.resolve()}):a.resolve();return this._driverSet=s.then(function(){var t=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(t).then(function(t){r._driver=t._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(t){return function(){var e=0;return function n(){for(;e<t.length;){var o=t[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(u).catch(n)}i();var c=new Error("No available storage method found.");return r._driverSet=a.reject(c),r._driverSet}()}}(o)})}).catch(function(){i();var t=new Error("No available storage method found.");return r._driverSet=a.reject(t),r._driverSet}),c(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!at[t]},t.prototype._extend=function(t){ht(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];this.supports(o)&&e.push(o)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=lt.length;t<e;t++)dt(this,lt[t])},t.prototype.createInstance=function(e){return new t(e)},t}());e.exports=pt},{3:3}]},{},[4])(4)})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],50:[function(t,e,n){e.exports=function(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}},{}],51:[function(t,e,n){var r=t("./_baseFindIndex"),o=t("./_baseIsNaN"),i=t("./_strictIndexOf");e.exports=function(t,e,n){return e==e?i(t,e,n):r(t,o,n)}},{"./_baseFindIndex":50,"./_baseIsNaN":52,"./_strictIndexOf":53}],52:[function(t,e,n){e.exports=function(t){return t!=t}},{}],53:[function(t,e,n){e.exports=function(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}},{}],54:[function(t,e,n){var r=Array.isArray;e.exports=r},{}],55:[function(t,e,n){e.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},{}],56:[function(t,e,n){e.exports=function(){}},{}],57:[function(t,e,n){var r,o;r=this,o=function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?r(Object(o),!0).forEach(function(e){n(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}var u=function(){function t(t,e){var n=t._tree,r=Object.keys(n);this.set=t,this.type=e,this.path=r.length>0?[{node:n,keys:r}]:[]}var e=t.prototype;return e.next=function(){var t=this.dive();return this.backtrack(),t},e.dive=function(){if(0===this.path.length)return{done:!0};var t=f(this.path),e=t.node,n=t.keys;return f(n)===l?{done:!1,value:this.result()}:(this.path.push({node:e[f(n)],keys:Object.keys(e[f(n)])}),this.dive())},e.backtrack=function(){0!==this.path.length&&(f(this.path).keys.pop(),f(this.path).keys.length>0||(this.path.pop(),this.backtrack()))},e.key=function(){return this.set._prefix+this.path.map(function(t){var e=t.keys;return f(e)}).filter(function(t){return t!==l}).join("")},e.value=function(){return f(this.path).node[l]},e.result=function(){return this.type===s?this.value():this.type===c?this.key():[this.key(),this.value()]},e[Symbol.iterator]=function(){return this},t}(),c="KEYS",s="VALUES",l="",f=function(t){return t[t.length-1]},d=function(t,e,n,r,o,i){i.push({distance:0,ia:r,ib:0,edit:o});for(var a=[];i.length>0;){var u=i.pop(),c=u.distance,s=u.ia,l=u.ib,f=u.edit;if(l!==e.length)if(t[s]===e[l])i.push({distance:c,ia:s+1,ib:l+1,edit:h});else{if(c>=n)continue;f!==g&&i.push({distance:c+1,ia:s,ib:l+1,edit:v}),s<t.length&&(f!==v&&i.push({distance:c+1,ia:s+1,ib:l,edit:g}),f!==v&&f!==g&&i.push({distance:c+1,ia:s+1,ib:l+1,edit:p}))}else a.push({distance:c,i:s,edit:f})}return a},h=0,p=1,g=2,v=3,m=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=""),this._tree=t,this._prefix=e}var n=t.prototype;return n.atPrefix=function(e){if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");var n=b(this._tree,e.slice(this._prefix.length)),r=n[0],o=n[1];if(void 0===r){var i,a=S(o),u=a[0],c=a[1],s=Object.keys(u).find(function(t){return t!==l&&t.startsWith(c)});if(void 0!==s)return new t(((i={})[s.slice(c.length)]=u[s],i),e)}return new t(r||{},e)},n.clear=function(){delete this._size,this._tree={}},n.delete=function(t){return delete this._size,_(this._tree,t)},n.entries=function(){return new u(this,"ENTRIES")},n.forEach=function(t){for(var e,n=a(this);!(e=n()).done;){var r=e.value;t(r[0],r[1],this)}},n.fuzzyGet=function(t,e){return function(t,e,n){for(var r=[{distance:0,i:0,key:"",node:t}],o={},i=[],a=function(){var t=r.pop(),a=t.node,u=t.distance,c=t.key,s=t.i,f=t.edit;Object.keys(a).forEach(function(t){if(t===l){var h=u+(e.length-s),p=(o[c]||[null,1/0])[1];h<=n&&h<p&&(o[c]=[a[t],h])}else d(e,t,n-u,s,f,i).forEach(function(e){var n=e.distance,o=e.i,i=e.edit;r.push({node:a[t],distance:u+n,key:c+t,i:o,edit:i})})})};r.length>0;)a();return o}(this._tree,t,e)},n.get=function(t){var e=w(this._tree,t);return void 0!==e?e[l]:void 0},n.has=function(t){var e=w(this._tree,t);return void 0!==e&&e.hasOwnProperty(l)},n.keys=function(){return new u(this,c)},n.set=function(t,e){if("string"!=typeof t)throw new Error("key must be a string");return delete this._size,x(this._tree,t)[l]=e,this},n.update=function(t,e){if("string"!=typeof t)throw new Error("key must be a string");delete this._size;var n=x(this._tree,t);return n[l]=e(n[l]),this},n.values=function(){return new u(this,s)},n[Symbol.iterator]=function(){return this.entries()},e(t,[{key:"size",get:function(){var t=this;return this._size?this._size:(this._size=0,this.forEach(function(){t._size+=1}),this._size)}}]),t}();m.from=function(t){for(var e,n=new m,r=a(t);!(e=r()).done;){var o=e.value,i=o[0],u=o[1];n.set(i,u)}return n},m.fromObject=function(t){return m.from(Object.entries(t))};var y,b=function t(e,n,r){if(void 0===r&&(r=[]),0===n.length)return[e,r];var o=Object.keys(e).find(function(t){return t!==l&&n.startsWith(t)});return void 0===o?t(void 0,"",[].concat(r,[[e,n]])):t(e[o],n.slice(o.length),[].concat(r,[[e,o]]))},w=function t(e,n){if(0===n.length)return e;var r=Object.keys(e).find(function(t){return t!==l&&n.startsWith(t)});return void 0!==r?t(e[r],n.slice(r.length)):void 0},x=function t(e,n){if(0===n.length)return e;var r=Object.keys(e).find(function(t){return t!==l&&n.startsWith(t)});if(void 0===r){var o=Object.keys(e).find(function(t){return t!==l&&t.startsWith(n[0])});if(void 0!==o){var i,a=k(n,o);return e[a]=((i={})[o.slice(a.length)]=e[o],i),delete e[o],t(e[a],n.slice(a.length))}return e[n]={},e[n]}return t(e[r],n.slice(r.length))},k=function t(e,n,r,o,i){return void 0===r&&(r=0),void 0===o&&(o=Math.min(e.length,n.length)),void 0===i&&(i=""),r>=o?i:e[r]!==n[r]?i:t(e,n,r+1,o,i+e[r])},_=function(t,e){var n=b(t,e),r=n[0],o=n[1];if(void 0!==r){delete r[l];var i=Object.keys(r);0===i.length&&I(o),1===i.length&&j(o,i[0],r[i[0]])}},I=function t(e){if(0!==e.length){var n=S(e),r=n[0];delete r[n[1]],0===Object.keys(r).length&&t(e.slice(0,-1))}},j=function(t,e,n){if(0!==t.length){var r=S(t),o=r[0],i=r[1];o[i+e]=n,delete o[i]}},S=function(t){return t[t.length-1]},A=function(){function t(t){void 0===t&&(t={}),this._options=o(o({},U),t),this._options.searchOptions=o(o({},q),this._options.searchOptions||{});var e=this._options.fields;if(null==e)throw new Error('MiniSearch: option "fields" must be provided');this._index=new m,this._documentCount=0,this._documentIds={},this._fieldIds={},this._fieldLength={},this._averageFieldLength={},this._nextId=0,this._storedFields={},T(this,e)}var n=t.prototype;return n.add=function(t){var e=this,n=this._options,r=n.extractField,o=n.tokenize,i=n.processTerm,a=n.fields,u=n.idField,c=r(t,u);if(null==c)throw new Error('MiniSearch: document does not have ID field "'+u+'"');var s=O(this,c);D(this,s,t),a.forEach(function(n){var a=r(t,n);if(null!=a){var u=o(a.toString(),n);P(e,s,e._fieldIds[n],e.documentCount-1,u.length),u.forEach(function(t){var r=i(t,n);z(r)&&E(e,e._fieldIds[n],s,r)})}})},n.addAll=function(t){var e=this;t.forEach(function(t){return e.add(t)})},n.addAllAsync=function(t,e){var n=this;void 0===e&&(e={});var r=e.chunkSize,o=void 0===r?10:r,i={chunk:[],promise:Promise.resolve(null)},a=t.reduce(function(t,e,r){var i=t.chunk,a=t.promise;return i.push(e),(r+1)%o==0?{chunk:[],promise:a.then(function(){return n.addAll(i)})}:{chunk:i,promise:a}},i),u=a.chunk;return a.promise.then(function(){return n.addAll(u)})},n.remove=function(t){var e=this,n=this._options,r=n.tokenize,o=n.processTerm,i=n.extractField,a=n.fields,u=n.idField,c=i(t,u);if(null==c)throw new Error('MiniSearch: document does not have ID field "'+u+'"');var s=(Object.entries(this._documentIds).find(function(t){t[0];var e=t[1];return c===e})||[])[0];if(null==s)throw new Error("MiniSearch: cannot remove document with ID "+c+": it is not in the index");a.forEach(function(n){var a=i(t,n);null!=a&&r(a.toString(),n).forEach(function(t){var r=o(t,n);z(r)&&$(e,e._fieldIds[n],s,r)})}),delete this._storedFields[s],delete this._documentIds[s],this._documentCount-=1},n.removeAll=function(t){var e=this;0===arguments.length?(this._index=new m,this._documentCount=0,this._documentIds={},this._fieldLength={},this._averageFieldLength={},this._storedFields={},this._nextId=0):t.forEach(function(t){return e.remove(t)})},n.search=function(t,e){var n=this;void 0===e&&(e={});var r=this._options,i=r.tokenize,a=r.processTerm,u=r.searchOptions,c=e=o(o({tokenize:i,processTerm:a},u),e),s=c.tokenize,l=c.processTerm,f=s(t).map(function(t){return l(t)}).filter(z).map(M(e)).map(function(t){return n.executeQuery(t,e)}),d=this.combineResults(f,e.combineWith);return Object.entries(d).reduce(function(t,r){var o=r[0],i=r[1],a=i.score,u=i.match,c=i.terms,s={id:n._documentIds[o],terms:B(c),score:a,match:u};return Object.assign(s,n._storedFields[o]),(null==e.filter||e.filter(s))&&t.push(s),t},[]).sort(function(t,e){return t.score<e.score?1:-1})},n.autoSuggest=function(t,e){void 0===e&&(e={}),e=o(o({},K),e);var n=this.search(t,e).reduce(function(t,e){var n=e.score,r=e.terms,o=r.join(" ");return null==t[o]?t[o]={score:n,terms:r,count:1}:(t[o].score+=n,t[o].count+=1),t},{});return Object.entries(n).map(function(t){var e=t[0],n=t[1],r=n.score;return{suggestion:e,terms:n.terms,score:r/n.count}}).sort(function(t,e){return t.score<e.score?1:-1})},t.loadJSON=function(e,n){if(null==n)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return t.loadJS(JSON.parse(e),n)},t.getDefault=function(t){if(U.hasOwnProperty(t))return U[t];throw new Error('MiniSearch: unknown option "'+t+'"')},t.loadJS=function(e,n){void 0===n&&(n={});var r=e.index,o=e.documentCount,i=e.nextId,a=e.documentIds,u=e.fieldIds,c=e.fieldLength,s=e.averageFieldLength,l=e.storedFields,f=new t(n);return f._index=new m(r._tree,r._prefix),f._documentCount=o,f._nextId=i,f._documentIds=a,f._fieldIds=u,f._fieldLength=c,f._averageFieldLength=s,f._fieldIds=u,f._storedFields=l||{},f},n.executeQuery=function(t,e){var n=this;void 0===e&&(e={});var r=((e=o(o({},this._options.searchOptions),e)).fields||this._options.fields).reduce(function(t,e){var n;return o(o({},t),{},((n={})[e]=L(t,e)||1,n))},e.boost||{}),i=e,a=i.boostDocument,u=i.weights,c=u.fuzzy,s=void 0===c?.9:c,l=u.prefix,f=void 0===l?.75:l,d=F(this,t.term,r,a,this._index.get(t.term));if(!t.fuzzy&&!t.prefix)return d;var h=[d];if(t.prefix&&this._index.atPrefix(t.term).forEach(function(e,o){var i=.3*(e.length-t.term.length)/e.length;h.push(F(n,e,r,a,o,f,i))}),t.fuzzy){var p=t.fuzzy<1?Math.round(t.term.length*t.fuzzy):t.fuzzy;Object.entries(this._index.fuzzyGet(t.term,p)).forEach(function(t){var e=t[0],o=t[1],i=o[0],u=o[1]/e.length;h.push(F(n,e,r,a,i,s,u))})}return h.reduce(R.or,{})},n.combineResults=function(t,e){if(void 0===e&&(e="or"),0===t.length)return{};var n=e.toLowerCase();return t.reduce(R[n],null)},n.toJSON=function(){return{index:this._index,documentCount:this._documentCount,nextId:this._nextId,documentIds:this._documentIds,fieldIds:this._fieldIds,fieldLength:this._fieldLength,averageFieldLength:this._averageFieldLength,storedFields:this._storedFields}},e(t,[{key:"documentCount",get:function(){return this._documentCount}}]),t}();A.SearchableMap=m;var E=function(t,e,n,r){t._index.update(r,function(t){var r,i=(t=t||{})[e]||{df:0,ds:{}};return null==i.ds[n]&&(i.df+=1),i.ds[n]=(i.ds[n]||0)+1,o(o({},t),{},((r={})[e]=i,r))})},$=function(t,e,n,r){t._index.has(r)?(t._index.update(r,function(i){var a,u=i[e];if(null==u||null==u.ds[n])return C(t,n,e,r),i;if(u.ds[n]<=1){if(u.df<=1)return delete i[e],i;u.df-=1}return u.ds[n]<=1?(delete u.ds[n],i):(u.ds[n]-=1,o(o({},i),{},((a={})[e]=u,a)))}),0===Object.keys(t._index.get(r)).length&&t._index.delete(r)):C(t,n,e,r)},C=function(t,e,n,r){if(null!=console&&null!=console.warn){var o=Object.entries(t._fieldIds).find(function(t){t[0];return t[1]===n})[0];console.warn("MiniSearch: document with ID "+t._documentIds[e]+' has changed before removal: term "'+r+'" was not present in field "'+o+'". Removing a document after it has changed can corrupt the index!')}},O=function(t,e){var n=t._nextId.toString(36);return t._documentIds[n]=e,t._documentCount+=1,t._nextId+=1,n},T=function(t,e){e.forEach(function(e,n){t._fieldIds[e]=n})},F=function(t,e,n,r,o,i,a){return void 0===a&&(a=0),null==o?{}:Object.entries(n).reduce(function(n,i){var u=i[0],c=i[1],s=t._fieldIds[u],l=o[s]||{ds:{}},f=l.df,d=l.ds;return Object.entries(d).forEach(function(o){var i=o[0],l=o[1],d=r?r(t._documentIds[i],e):1;if(d){var h=t._fieldLength[i][s]/t._averageFieldLength[s];n[i]=n[i]||{score:0,match:{},terms:[]},n[i].terms.push(e),n[i].match[e]=L(n[i].match,e)||[],n[i].score+=d*N(l,f,t._documentCount,h,c,a),n[i].match[e].push(u)}}),n},{})},L=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},P=function(t,e,n,r,o){t._averageFieldLength[n]=t._averageFieldLength[n]||0;var i=t._averageFieldLength[n]*r+o;t._fieldLength[e]=t._fieldLength[e]||{},t._fieldLength[e][n]=o,t._averageFieldLength[n]=i/(r+1)},D=function(t,e,n){var r=t._options,o=r.storeFields,i=r.extractField;null!=o&&0!==o.length&&(t._storedFields[e]=t._storedFields[e]||{},o.forEach(function(r){var o=i(n,r);void 0!==o&&(t._storedFields[e][r]=o)}))},R=((y={}).or=function(t,e){return Object.entries(e).reduce(function(t,e){var n=e[0],r=e[1],o=r.score,i=r.match,a=r.terms;return null==t[n]?t[n]={score:o,match:i,terms:a}:(t[n].score+=o,t[n].score*=1.5,t[n].terms=[].concat(t[n].terms,a),Object.assign(t[n].match,i)),t},t||{})},y.and=function(t,e){return null==t?e:Object.entries(e).reduce(function(e,n){var r=n[0],i=n[1],a=i.score,u=i.match,c=i.terms;return void 0===t[r]?e:(e[r]=e[r]||{},e[r].score=t[r].score+a,e[r].match=o(o({},t[r].match),u),e[r].terms=[].concat(t[r].terms,c),e)},{})},y),N=function(t,e,n,r,o,i){var a,u;return o/(1+.333*o*i)*(a=e,u=n,t*Math.log(u/a))/r},M=function(t){return function(e,n,r){return{term:e,fuzzy:"function"==typeof t.fuzzy?t.fuzzy(e,n,r):t.fuzzy,prefix:"function"==typeof t.prefix?t.prefix(e,n,r):t.prefix}}},B=function(t){return t.filter(function(t,e,n){return n.indexOf(t)===e})},z=function(t){return!!t},U={idField:"id",extractField:function(t,e){return t[e]},tokenize:function(t,e){return t.split(W)},processTerm:function(t,e){return t.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[]},q={combineWith:"or",prefix:!1,fuzzy:!1,weights:{}},K={prefix:function(t,e,n){return e===n.length-1}},W=/[\n\r -#%-\*,-\/:;\?@\[-\]_\{\}\xA0\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/;return A},"object"==typeof n&&void 0!==e?e.exports=o():"function"==typeof define&&define.amd?define(o):(r="undefined"!=typeof globalThis?globalThis:r||self).MiniSearch=o()},{}],58:[function(t,e,n){var r,o,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{o="function"==typeof clearTimeout?clearTimeout:u}catch(t){o=u}}();var s,l=[],f=!1,d=-1;function h(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&p())}function p(){if(!f){var t=c(h);f=!0;for(var e=l.length;e;){for(s=l,l=[];++d<e;)s&&s[d].run();d=-1,e=l.length}s=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===u||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new g(t,e)),1!==l.length||f||c(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],59:[function(t,e,n){(function(t){(function(){!function(r){var o="object"==typeof n&&n&&!n.nodeType&&n,i="object"==typeof e&&e&&!e.nodeType&&e,a="object"==typeof t&&t;a.global!==a&&a.window!==a&&a.self!==a||(r=a);var u,c,s=2147483647,l=36,f=1,d=26,h=38,p=700,g=72,v=128,m="-",y=/^xn--/,b=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},k=l-f,_=Math.floor,I=String.fromCharCode;function j(t){throw new RangeError(x[t])}function S(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function A(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+S((t=t.replace(w,".")).split("."),e).join(".")}function E(t){for(var e,n,r=[],o=0,i=t.length;o<i;)(e=t.charCodeAt(o++))>=55296&&e<=56319&&o<i?56320==(64512&(n=t.charCodeAt(o++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),o--):r.push(e);return r}function $(t){return S(t,function(t){var e="";return t>65535&&(e+=I((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=I(t)}).join("")}function C(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function O(t,e,n){var r=0;for(t=n?_(t/p):t>>1,t+=_(t/e);t>k*d>>1;r+=l)t=_(t/k);return _(r+(k+1)*t/(t+h))}function T(t){var e,n,r,o,i,a,u,c,h,p,y,b=[],w=t.length,x=0,k=v,I=g;for((n=t.lastIndexOf(m))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&j("not-basic"),b.push(t.charCodeAt(r));for(o=n>0?n+1:0;o<w;){for(i=x,a=1,u=l;o>=w&&j("invalid-input"),((c=(y=t.charCodeAt(o++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:l)>=l||c>_((s-x)/a))&&j("overflow"),x+=c*a,!(c<(h=u<=I?f:u>=I+d?d:u-I));u+=l)a>_(s/(p=l-h))&&j("overflow"),a*=p;I=O(x-i,e=b.length+1,0==i),_(x/e)>s-k&&j("overflow"),k+=_(x/e),x%=e,b.splice(x++,0,k)}return $(b)}function F(t){var e,n,r,o,i,a,u,c,h,p,y,b,w,x,k,S=[];for(b=(t=E(t)).length,e=v,n=0,i=g,a=0;a<b;++a)(y=t[a])<128&&S.push(I(y));for(r=o=S.length,o&&S.push(m);r<b;){for(u=s,a=0;a<b;++a)(y=t[a])>=e&&y<u&&(u=y);for(u-e>_((s-n)/(w=r+1))&&j("overflow"),n+=(u-e)*w,e=u,a=0;a<b;++a)if((y=t[a])<e&&++n>s&&j("overflow"),y==e){for(c=n,h=l;!(c<(p=h<=i?f:h>=i+d?d:h-i));h+=l)k=c-p,x=l-p,S.push(I(C(p+k%x,0))),c=_(k/x);S.push(I(C(c,0))),i=O(n,w,r==o),n=0,++r}++n,++e}return S.join("")}if(u={version:"1.4.1",ucs2:{decode:E,encode:$},decode:T,encode:F,toASCII:function(t){return A(t,function(t){return b.test(t)?"xn--"+F(t):t})},toUnicode:function(t){return A(t,function(t){return y.test(t)?T(t.slice(4).toLowerCase()):t})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return u});else if(o&&i)if(e.exports==o)i.exports=u;else for(c in u)u.hasOwnProperty(c)&&(o[c]=u[c]);else r.punycode=u}(this)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],60:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,i){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var u=/\+/g;t=t.split(e);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var s=t.length;c>0&&s>c&&(s=c);for(var l=0;l<s;++l){var f,d,h,p,g=t[l].replace(u,"%20"),v=g.indexOf(n);v>=0?(f=g.substr(0,v),d=g.substr(v+1)):(f=g,d=""),h=decodeURIComponent(f),p=decodeURIComponent(d),r(a,h)?o(a[h])?a[h].push(p):a[h]=[a[h],p]:a[h]=p}return a};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],61:[function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,u){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?i(a(t),function(a){var u=encodeURIComponent(r(a))+n;return o(t[a])?i(t[a],function(t){return u+encodeURIComponent(r(t))}).join(e):u+encodeURIComponent(r(t[a]))}).join(e):u?encodeURIComponent(r(u))+n+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],62:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":60,"./encode":61}],63:[function(t,e,n){(function(e,r){(function(){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,a=Array.prototype.slice,u={},c=0;function s(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n.setImmediate="function"==typeof e?e:function(t){var e=c++,r=!(arguments.length<2)&&a.call(arguments,1);return u[e]=!0,o(function(){u[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))}),e},n.clearImmediate="function"==typeof r?r:function(t){delete u[t]}}).call(this)}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":58,timers:63}],64:[function(t,e,n){(function(t){(function(){!function(t,r){"object"==typeof n&&void 0!==e?e.exports=r():"function"==typeof define&&define.amd?define("underscore",r):(t=t||self,function(){var e=t._,n=t._=r();n.noConflict=function(){return t._=e,n}}())}(this,function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||Function("return this")()||{},n=Array.prototype,r=Object.prototype,o="undefined"!=typeof Symbol?Symbol.prototype:null,i=n.push,a=n.slice,u=r.toString,c=r.hasOwnProperty,s="undefined"!=typeof ArrayBuffer,l="undefined"!=typeof DataView,f=Array.isArray,d=Object.keys,h=Object.create,p=s&&ArrayBuffer.isView,g=isNaN,v=isFinite,m=!{toString:null}.propertyIsEnumerable("toString"),y=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],b=Math.pow(2,53)-1;function w(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),o=0;o<n;o++)r[o]=arguments[o+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var i=Array(e+1);for(o=0;o<e;o++)i[o]=arguments[o];return i[e]=r,t.apply(this,i)}}function x(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function k(t){return void 0===t}function _(t){return!0===t||!1===t||"[object Boolean]"===u.call(t)}function I(t){var e="[object "+t+"]";return function(t){return u.call(t)===e}}var j=I("String"),S=I("Number"),A=I("Date"),E=I("RegExp"),$=I("Error"),C=I("Symbol"),O=I("ArrayBuffer"),T=I("Function"),F=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof F&&(T=function(t){return"function"==typeof t||!1});var L=T,P=I("Object"),D=l&&P(new DataView(new ArrayBuffer(8))),R="undefined"!=typeof Map&&P(new Map),N=I("DataView");var M=D?function(t){return null!=t&&L(t.getInt8)&&O(t.buffer)}:N,B=f||I("Array");function z(t,e){return null!=t&&c.call(t,e)}var U=I("Arguments");!function(){U(arguments)||(U=function(t){return z(t,"callee")})}();var q=U;function K(t){return S(t)&&g(t)}function W(t){return function(){return t}}function H(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=b}}function J(t){return function(e){return null==e?void 0:e[t]}}var G=J("byteLength"),V=H(G),Y=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Q=s?function(t){return p?p(t)&&!M(t):V(t)&&Y.test(u.call(t))}:W(!1),X=J("length");function Z(t,e){e=function(t){for(var e={},n=t.length,r=0;r<n;++r)e[t[r]]=!0;return{contains:function(t){return e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=y.length,o=t.constructor,i=L(o)&&o.prototype||r,a="constructor";for(z(t,a)&&!e.contains(a)&&e.push(a);n--;)(a=y[n])in t&&t[a]!==i[a]&&!e.contains(a)&&e.push(a)}function tt(t){if(!x(t))return[];if(d)return d(t);var e=[];for(var n in t)z(t,n)&&e.push(n);return m&&Z(t,e),e}function et(t,e){var n=tt(e),r=n.length;if(null==t)return!r;for(var o=Object(t),i=0;i<r;i++){var a=n[i];if(e[a]!==o[a]||!(a in o))return!1}return!0}function nt(t){return t instanceof nt?t:this instanceof nt?void(this._wrapped=t):new nt(t)}function rt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,G(t))}nt.VERSION="1.12.0",nt.prototype.value=function(){return this._wrapped},nt.prototype.valueOf=nt.prototype.toJSON=nt.prototype.value,nt.prototype.toString=function(){return String(this._wrapped)};var ot="[object DataView]";function it(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&function t(e,n,r,i){e instanceof nt&&(e=e._wrapped);n instanceof nt&&(n=n._wrapped);var a=u.call(e);if(a!==u.call(n))return!1;if(D&&"[object Object]"==a&&M(e)){if(!M(n))return!1;a=ot}switch(a){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return o.valueOf.call(e)===o.valueOf.call(n);case"[object ArrayBuffer]":case ot:return t(rt(e),rt(n),r,i)}var c="[object Array]"===a;if(!c&&Q(e)){var s=G(e);if(s!==G(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;c=!0}if(!c){if("object"!=typeof e||"object"!=typeof n)return!1;var l=e.constructor,f=n.constructor;if(l!==f&&!(L(l)&&l instanceof l&&L(f)&&f instanceof f)&&"constructor"in e&&"constructor"in n)return!1}r=r||[];i=i||[];var d=r.length;for(;d--;)if(r[d]===e)return i[d]===n;r.push(e);i.push(n);if(c){if((d=e.length)!==n.length)return!1;for(;d--;)if(!it(e[d],n[d],r,i))return!1}else{var h,p=tt(e);if(d=p.length,tt(n).length!==d)return!1;for(;d--;)if(h=p[d],!z(n,h)||!it(e[h],n[h],r,i))return!1}r.pop();i.pop();return!0}(t,e,n,r)}function at(t){if(!x(t))return[];var e=[];for(var n in t)e.push(n);return m&&Z(t,e),e}function ut(t){var e=X(t);return function(n){if(null==n)return!1;var r=at(n);if(X(r))return!1;for(var o=0;o<e;o++)if(!L(n[t[o]]))return!1;return t!==dt||!L(n[ct])}}var ct="forEach",st=["clear","delete"],lt=["get","has","set"],ft=st.concat(ct,lt),dt=st.concat(lt),ht=["add"].concat(st,ct,"has"),pt=R?ut(ft):I("Map"),gt=R?ut(dt):I("WeakMap"),vt=R?ut(ht):I("Set"),mt=I("WeakSet");function yt(t){for(var e=tt(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t[e[o]];return r}function bt(t){for(var e={},n=tt(t),r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r];return e}function wt(t){var e=[];for(var n in t)L(t[n])&&e.push(n);return e.sort()}function xt(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var o=1;o<r;o++)for(var i=arguments[o],a=t(i),u=a.length,c=0;c<u;c++){var s=a[c];e&&void 0!==n[s]||(n[s]=i[s])}return n}}var kt=xt(at),_t=xt(tt),It=xt(at,!0);function jt(t){if(!x(t))return{};if(h)return h(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function St(t){return x(t)?B(t)?t.slice():kt({},t):t}function At(t){return B(t)?t:[t]}function Et(t){return nt.toPath(t)}function $t(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function Ct(t,e,n){var r=$t(t,Et(e));return k(r)?n:r}function Ot(t){return t}function Tt(t){return t=_t({},t),function(e){return et(e,t)}}function Ft(t){return t=Et(t),function(e){return $t(e,t)}}function Lt(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)}}return function(){return t.apply(e,arguments)}}function Pt(t,e,n){return null==t?Ot:L(t)?Lt(t,e,n):x(t)&&!B(t)?Tt(t):Ft(t)}function Dt(t,e){return Pt(t,e,1/0)}function Rt(t,e,n){return nt.iteratee!==Dt?nt.iteratee(t,e):Pt(t,e,n)}function Nt(){}function Mt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}nt.toPath=At,nt.iteratee=Dt;var Bt=Date.now||function(){return(new Date).getTime()};function zt(t){var e=function(e){return t[e]},n="(?:"+tt(t).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(o,e):t}}var Ut={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},qt=zt(Ut),Kt=zt(bt(Ut)),Wt=nt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Ht=/(.)^/,Jt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Gt=/\\|'|\r|\n|\u2028|\u2029/g;function Vt(t){return"\\"+Jt[t]}var Yt=0;function Qt(t,e,n,r,o){if(!(r instanceof e))return t.apply(n,o);var i=jt(t.prototype),a=t.apply(i,o);return x(a)?a:i}var Xt=w(function(t,e){var n=Xt.placeholder,r=function(){for(var o=0,i=e.length,a=Array(i),u=0;u<i;u++)a[u]=e[u]===n?arguments[o++]:e[u];for(;o<arguments.length;)a.push(arguments[o++]);return Qt(t,r,this,this,a)};return r});Xt.placeholder=nt;var Zt=w(function(t,e,n){if(!L(t))throw new TypeError("Bind must be called on a function");var r=w(function(o){return Qt(t,r,e,this,n.concat(o))});return r}),te=H(X);function ee(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var o=r.length,i=0,a=X(t);i<a;i++){var u=t[i];if(te(u)&&(B(u)||q(u)))if(e>1)ee(u,e-1,n,r),o=r.length;else for(var c=0,s=u.length;c<s;)r[o++]=u[c++];else n||(r[o++]=u)}return r}var ne=w(function(t,e){var n=(e=ee(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=Zt(t[r],t)}return t});var re=w(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),oe=Xt(re,nt,1);function ie(t){return function(){return!t.apply(this,arguments)}}function ae(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var ue=Xt(ae,2);function ce(t,e,n){e=Rt(e,n);for(var r,o=tt(t),i=0,a=o.length;i<a;i++)if(e(t[r=o[i]],r,t))return r}function se(t){return function(e,n,r){n=Rt(n,r);for(var o=X(e),i=t>0?0:o-1;i>=0&&i<o;i+=t)if(n(e[i],i,e))return i;return-1}}var le=se(1),fe=se(-1);function de(t,e,n,r){for(var o=(n=Rt(n,r,1))(e),i=0,a=X(t);i<a;){var u=Math.floor((i+a)/2);n(t[u])<o?i=u+1:a=u}return i}function he(t,e,n){return function(r,o,i){var u=0,c=X(r);if("number"==typeof i)t>0?u=i>=0?i:Math.max(i+c,u):c=i>=0?Math.min(i+1,c):i+c+1;else if(n&&i&&c)return r[i=n(r,o)]===o?i:-1;if(o!=o)return(i=e(a.call(r,u,c),K))>=0?i+u:-1;for(i=t>0?u:c-1;i>=0&&i<c;i+=t)if(r[i]===o)return i;return-1}}var pe=he(1,le,de),ge=he(-1,fe);function ve(t,e,n){var r=(te(t)?le:ce)(t,e,n);if(void 0!==r&&-1!==r)return t[r]}function me(t,e,n){var r,o;if(e=Lt(e,n),te(t))for(r=0,o=t.length;r<o;r++)e(t[r],r,t);else{var i=tt(t);for(r=0,o=i.length;r<o;r++)e(t[i[r]],i[r],t)}return t}function ye(t,e,n){e=Rt(e,n);for(var r=!te(t)&&tt(t),o=(r||t).length,i=Array(o),a=0;a<o;a++){var u=r?r[a]:a;i[a]=e(t[u],u,t)}return i}function be(t){return function(e,n,r,o){var i=arguments.length>=3;return function(e,n,r,o){var i=!te(e)&&tt(e),a=(i||e).length,u=t>0?0:a-1;for(o||(r=e[i?i[u]:u],u+=t);u>=0&&u<a;u+=t){var c=i?i[u]:u;r=n(r,e[c],c,e)}return r}(e,Lt(n,o,4),r,i)}}var we=be(1),xe=be(-1);function ke(t,e,n){var r=[];return e=Rt(e,n),me(t,function(t,n,o){e(t,n,o)&&r.push(t)}),r}function _e(t,e,n){e=Rt(e,n);for(var r=!te(t)&&tt(t),o=(r||t).length,i=0;i<o;i++){var a=r?r[i]:i;if(!e(t[a],a,t))return!1}return!0}function Ie(t,e,n){e=Rt(e,n);for(var r=!te(t)&&tt(t),o=(r||t).length,i=0;i<o;i++){var a=r?r[i]:i;if(e(t[a],a,t))return!0}return!1}function je(t,e,n,r){return te(t)||(t=yt(t)),("number"!=typeof n||r)&&(n=0),pe(t,e,n)>=0}var Se=w(function(t,e,n){var r,o;return L(e)?o=e:(e=Et(e),r=e.slice(0,-1),e=e[e.length-1]),ye(t,function(t){var i=o;if(!i){if(r&&r.length&&(t=$t(t,r)),null==t)return;i=t[e]}return null==i?i:i.apply(t,n)})});function Ae(t,e){return ye(t,Ft(e))}function Ee(t,e,n){var r,o,i=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var u=0,c=(t=te(t)?t:yt(t)).length;u<c;u++)null!=(r=t[u])&&r>i&&(i=r);else e=Rt(e,n),me(t,function(t,n,r){((o=e(t,n,r))>a||o===-1/0&&i===-1/0)&&(i=t,a=o)});return i}function $e(t,e,n){if(null==e||n)return te(t)||(t=yt(t)),t[Mt(t.length-1)];var r=te(t)?St(t):yt(t),o=X(r);e=Math.max(Math.min(e,o),0);for(var i=o-1,a=0;a<e;a++){var u=Mt(a,i),c=r[a];r[a]=r[u],r[u]=c}return r.slice(0,e)}function Ce(t,e){return function(n,r,o){var i=e?[[],[]]:{};return r=Rt(r,o),me(n,function(e,o){var a=r(e,o,n);t(i,e,a)}),i}}var Oe=Ce(function(t,e,n){z(t,n)?t[n].push(e):t[n]=[e]}),Te=Ce(function(t,e,n){t[n]=e}),Fe=Ce(function(t,e,n){z(t,n)?t[n]++:t[n]=1}),Le=Ce(function(t,e,n){t[n?0:1].push(e)},!0),Pe=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function De(t,e,n){return e in n}var Re=w(function(t,e){var n={},r=e[0];if(null==t)return n;L(r)?(e.length>1&&(r=Lt(r,e[1])),e=at(t)):(r=De,e=ee(e,!1,!1),t=Object(t));for(var o=0,i=e.length;o<i;o++){var a=e[o],u=t[a];r(u,a,t)&&(n[a]=u)}return n}),Ne=w(function(t,e){var n,r=e[0];return L(r)?(r=ie(r),e.length>1&&(n=e[1])):(e=ye(ee(e,!1,!1),String),r=function(t,n){return!je(e,n)}),Re(t,r,n)});function Me(t,e,n){return a.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function Be(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:Me(t,t.length-e)}function ze(t,e,n){return a.call(t,null==e||n?1:e)}var Ue=w(function(t,e){return e=ee(e,!0,!0),ke(t,function(t){return!je(e,t)})}),qe=w(function(t,e){return Ue(t,e)});function Ke(t,e,n,r){_(e)||(r=n,n=e,e=!1),null!=n&&(n=Rt(n,r));for(var o=[],i=[],a=0,u=X(t);a<u;a++){var c=t[a],s=n?n(c,a,t):c;e&&!n?(a&&i===s||o.push(c),i=s):n?je(i,s)||(i.push(s),o.push(c)):je(o,c)||o.push(c)}return o}var We=w(function(t){return Ke(ee(t,!0,!0))});function He(t){for(var e=t&&Ee(t,X).length||0,n=Array(e),r=0;r<e;r++)n[r]=Ae(t,r);return n}var Je=w(He);function Ge(t,e){return t._chain?nt(e).chain():e}function Ve(t){return me(wt(t),function(e){var n=nt[e]=t[e];nt.prototype[e]=function(){var t=[this._wrapped];return i.apply(t,arguments),Ge(this,n.apply(nt,t))}}),nt}me(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];nt.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),Ge(this,n)}}),me(["concat","join","slice"],function(t){var e=n[t];nt.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Ge(this,t)}});var Ye=Ve({__proto__:null,VERSION:"1.12.0",restArguments:w,isObject:x,isNull:function(t){return null===t},isUndefined:k,isBoolean:_,isElement:function(t){return!(!t||1!==t.nodeType)},isString:j,isNumber:S,isDate:A,isRegExp:E,isError:$,isSymbol:C,isArrayBuffer:O,isDataView:M,isArray:B,isFunction:L,isArguments:q,isFinite:function(t){return!C(t)&&v(t)&&!isNaN(parseFloat(t))},isNaN:K,isTypedArray:Q,isEmpty:function(t){if(null==t)return!0;var e=X(t);return"number"==typeof e&&(B(t)||j(t)||q(t))?0===e:0===X(tt(t))},isMatch:et,isEqual:function(t,e){return it(t,e)},isMap:pt,isWeakMap:gt,isSet:vt,isWeakSet:mt,keys:tt,allKeys:at,values:yt,pairs:function(t){for(var e=tt(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=[e[o],t[e[o]]];return r},invert:bt,functions:wt,methods:wt,extend:kt,extendOwn:_t,assign:_t,defaults:It,create:function(t,e){var n=jt(t);return e&&_t(n,e),n},clone:St,tap:function(t,e){return e(t),t},get:Ct,has:function(t,e){for(var n=(e=Et(e)).length,r=0;r<n;r++){var o=e[r];if(!z(t,o))return!1;t=t[o]}return!!n},mapObject:function(t,e,n){e=Rt(e,n);for(var r=tt(t),o=r.length,i={},a=0;a<o;a++){var u=r[a];i[u]=e(t[u],u,t)}return i},identity:Ot,constant:W,noop:Nt,toPath:At,property:Ft,propertyOf:function(t){return null==t?Nt:function(e){return Ct(t,e)}},matcher:Tt,matches:Tt,times:function(t,e,n){var r=Array(Math.max(0,t));e=Lt(e,n,1);for(var o=0;o<t;o++)r[o]=e(o);return r},random:Mt,now:Bt,escape:qt,unescape:Kt,templateSettings:Wt,template:function(t,e,n){!e&&n&&(e=n),e=It({},e,nt.templateSettings);var r,o=RegExp([(e.escape||Ht).source,(e.interpolate||Ht).source,(e.evaluate||Ht).source].join("|")+"|$","g"),i=0,a="__p+='";t.replace(o,function(e,n,r,o,u){return a+=t.slice(i,u).replace(Gt,Vt),i=u+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(a+="';\n"+o+"\n__p+='"),e}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(e.variable||"obj","_",a)}catch(t){throw t.source=a,t}var u=function(t){return r.call(this,t,nt)},c=e.variable||"obj";return u.source="function("+c+"){\n"+a+"}",u},result:function(t,e,n){var r=(e=Et(e)).length;if(!r)return L(n)?n.call(t):n;for(var o=0;o<r;o++){var i=null==t?void 0:t[e[o]];void 0===i&&(i=n,o=r),t=L(i)?i.call(t):i}return t},uniqueId:function(t){var e=++Yt+"";return t?t+e:e},chain:function(t){var e=nt(t);return e._chain=!0,e},iteratee:Dt,partial:Xt,bind:Zt,bindAll:ne,memoize:function(t,e){var n=function(r){var o=n.cache,i=""+(e?e.apply(this,arguments):r);return z(o,i)||(o[i]=t.apply(this,arguments)),o[i]};return n.cache={},n},delay:re,defer:oe,throttle:function(t,e,n){var r,o,i,a,u=0;n||(n={});var c=function(){u=!1===n.leading?0:Bt(),r=null,a=t.apply(o,i),r||(o=i=null)},s=function(){var s=Bt();u||!1!==n.leading||(u=s);var l=e-(s-u);return o=this,i=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),u=s,a=t.apply(o,i),r||(o=i=null)):r||!1===n.trailing||(r=setTimeout(c,l)),a};return s.cancel=function(){clearTimeout(r),u=0,r=o=i=null},s},debounce:function(t,e,n){var r,o,i=function(e,n){r=null,n&&(o=t.apply(e,n))},a=w(function(a){if(r&&clearTimeout(r),n){var u=!r;r=setTimeout(i,e),u&&(o=t.apply(this,a))}else r=re(i,e,this,a);return o});return a.cancel=function(){clearTimeout(r),r=null},a},wrap:function(t,e){return Xt(e,t)},negate:ie,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:ae,once:ue,findKey:ce,findIndex:le,findLastIndex:fe,sortedIndex:de,indexOf:pe,lastIndexOf:ge,find:ve,detect:ve,findWhere:function(t,e){return ve(t,Tt(e))},each:me,forEach:me,map:ye,collect:ye,reduce:we,foldl:we,inject:we,reduceRight:xe,foldr:xe,filter:ke,select:ke,reject:function(t,e,n){return ke(t,ie(Rt(e)),n)},every:_e,all:_e,some:Ie,any:Ie,contains:je,includes:je,include:je,invoke:Se,pluck:Ae,where:function(t,e){return ke(t,Tt(e))},max:Ee,min:function(t,e,n){var r,o,i=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var u=0,c=(t=te(t)?t:yt(t)).length;u<c;u++)null!=(r=t[u])&&r<i&&(i=r);else e=Rt(e,n),me(t,function(t,n,r){((o=e(t,n,r))<a||o===1/0&&i===1/0)&&(i=t,a=o)});return i},shuffle:function(t){return $e(t,1/0)},sample:$e,sortBy:function(t,e,n){var r=0;return e=Rt(e,n),Ae(ye(t,function(t,n,o){return{value:t,index:r++,criteria:e(t,n,o)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")},groupBy:Oe,indexBy:Te,countBy:Fe,partition:Le,toArray:function(t){return t?B(t)?a.call(t):j(t)?t.match(Pe):te(t)?ye(t,Ot):yt(t):[]},size:function(t){return null==t?0:te(t)?t.length:tt(t).length},pick:Re,omit:Ne,first:Be,head:Be,take:Be,initial:Me,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:ze(t,Math.max(0,t.length-e))},rest:ze,tail:ze,drop:ze,compact:function(t){return ke(t,Boolean)},flatten:function(t,e){return ee(t,e,!1)},without:qe,uniq:Ke,unique:Ke,union:We,intersection:function(t){for(var e=[],n=arguments.length,r=0,o=X(t);r<o;r++){var i=t[r];if(!je(e,i)){var a;for(a=1;a<n&&je(arguments[a],i);a++);a===n&&e.push(i)}}return e},difference:Ue,unzip:He,transpose:He,zip:Je,object:function(t,e){for(var n={},r=0,o=X(t);r<o;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),o=Array(r),i=0;i<r;i++,t+=n)o[i]=t;return o},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,o=t.length;r<o;)n.push(a.call(t,r,r+=e));return n},mixin:Ve,default:nt});return Ye._=Ye,Ye})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],65:[function(t,e,n){"use strict";var r=t("punycode"),o=t("./util");function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=b,n.resolve=function(t,e){return b(t,!1,!0).resolve(e)},n.resolveObject=function(t,e){return t?b(t,!1,!0).resolveObject(e):e},n.format=function(t){o.isString(t)&&(t=b(t));return t instanceof i?t.format():i.prototype.format.call(t)},n.Url=i;var a=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,s=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(s),f=["%","/","?",";","#"].concat(l),d=["/","?","#"],h=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=t("querystring");function b(t,e,n){if(t&&o.isObject(t)&&t instanceof i)return t;var r=new i;return r.parse(t,e,n),r}i.prototype.parse=function(t,e,n){if(!o.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),u=-1!==i&&i<t.indexOf("#")?"?":"#",s=t.split(u);s[0]=s[0].replace(/\\/g,"/");var b=t=s.join(u);if(b=b.trim(),!n&&1===t.split("#").length){var w=c.exec(b);if(w)return this.path=b,this.href=b,this.pathname=w[1],w[2]?(this.search=w[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=a.exec(b);if(x){var k=(x=x[0]).toLowerCase();this.protocol=k,b=b.substr(x.length)}if(n||x||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var _="//"===b.substr(0,2);!_||x&&v[x]||(b=b.substr(2),this.slashes=!0)}if(!v[x]&&(_||x&&!m[x])){for(var I,j,S=-1,A=0;A<d.length;A++){-1!==(E=b.indexOf(d[A]))&&(-1===S||E<S)&&(S=E)}-1!==(j=-1===S?b.lastIndexOf("@"):b.lastIndexOf("@",S))&&(I=b.slice(0,j),b=b.slice(j+1),this.auth=decodeURIComponent(I)),S=-1;for(A=0;A<f.length;A++){var E;-1!==(E=b.indexOf(f[A]))&&(-1===S||E<S)&&(S=E)}-1===S&&(S=b.length),this.host=b.slice(0,S),b=b.slice(S),this.parseHost(),this.hostname=this.hostname||"";var $="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!$)for(var C=this.hostname.split(/\./),O=(A=0,C.length);A<O;A++){var T=C[A];if(T&&!T.match(h)){for(var F="",L=0,P=T.length;L<P;L++)T.charCodeAt(L)>127?F+="x":F+=T[L];if(!F.match(h)){var D=C.slice(0,A),R=C.slice(A+1),N=T.match(p);N&&(D.push(N[1]),R.unshift(N[2])),R.length&&(b="/"+R.join(".")+b),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),$||(this.hostname=r.toASCII(this.hostname));var M=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+M,this.href+=this.host,$&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!g[k])for(A=0,O=l.length;A<O;A++){var z=l[A];if(-1!==b.indexOf(z)){var U=encodeURIComponent(z);U===z&&(U=escape(z)),b=b.split(z).join(U)}}var q=b.indexOf("#");-1!==q&&(this.hash=b.substr(q),b=b.slice(0,q));var K=b.indexOf("?");if(-1!==K?(this.search=b.substr(K),this.query=b.substr(K+1),e&&(this.query=y.parse(this.query)),b=b.slice(0,K)):e&&(this.search="",this.query={}),b&&(this.pathname=b),m[k]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){M=this.pathname||"";var W=this.search||"";this.path=M+W}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,a="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var u=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||m[e])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),u&&"?"!==u.charAt(0)&&(u="?"+u),e+i+(n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(u=u.replace("#","%23"))+r},i.prototype.resolve=function(t){return this.resolveObject(b(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if(o.isString(t)){var e=new i;e.parse(t,!1,!0),t=e}for(var n=new i,r=Object.keys(this),a=0;a<r.length;a++){var u=r[a];n[u]=this[u]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var c=Object.keys(t),s=0;s<c.length;s++){var l=c[s];"protocol"!==l&&(n[l]=t[l])}return m[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!m[t.protocol]){for(var f=Object.keys(t),d=0;d<f.length;d++){var h=f[d];n[h]=t[h]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||v[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var g=n.pathname||"",y=n.search||"";n.path=g+y}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),w=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=w||b||n.host&&t.pathname,k=x,_=n.pathname&&n.pathname.split("/")||[],I=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!m[n.protocol]);if(I&&(n.hostname="",n.port=null,n.host&&(""===_[0]?_[0]=n.host:_.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),x=x&&(""===p[0]||""===_[0])),w)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,_=p;else if(p.length)_||(_=[]),_.pop(),_=_.concat(p),n.search=t.search,n.query=t.query;else if(!o.isNullOrUndefined(t.search)){if(I)n.hostname=n.host=_.shift(),($=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=$.shift(),n.host=n.hostname=$.shift());return n.search=t.search,n.query=t.query,o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!_.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var j=_.slice(-1)[0],S=(n.host||t.host||_.length>1)&&("."===j||".."===j)||""===j,A=0,E=_.length;E>=0;E--)"."===(j=_[E])?_.splice(E,1):".."===j?(_.splice(E,1),A++):A&&(_.splice(E,1),A--);if(!x&&!k)for(;A--;A)_.unshift("..");!x||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),S&&"/"!==_.join("/").substr(-1)&&_.push("");var $,C=""===_[0]||_[0]&&"/"===_[0].charAt(0);I&&(n.hostname=n.host=C?"":_.length?_.shift():"",($=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=$.shift(),n.host=n.hostname=$.shift()));return(x=x||n.host&&_.length)&&!C&&_.unshift(""),_.length?n.pathname=_.join("/"):(n.pathname=null,n.path=null),o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=u.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":66,punycode:59,querystring:62}],66:[function(t,e,n){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}]},{},[1]);
//# sourceMappingURL=client.map